{"pageProps":{"slug":"use-sudoers-file","blog":{"author":"Gao","content":"想要使用`iftop`查看一下网卡流量，发现这个命令需要root权限才可以使用，又不想切换账号，所以，使用sudo来执行这个命令就成了解决方案。\n\n### 使用`sudo`与配置`/etc/sudoers`文件\n\n使用sudo需要了机sudoers配置文件，文件保存在`/etc/sudoers`里。\n\n文件内容：\n\n```sudoers\nDefaults        env_reset\nDefaults        mail_badpass\nDefaults        secure_path=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin\"\n\nroot    ALL=(ALL:ALL) ALL\n\n%wheel ALL=(ALL) ALL\n%sudo   ALL=(ALL:ALL) ALL\n\n#includedir /etc/sudoers.d\n```\n\n第一行 `Defaults        env_reset`表示重置所有用户环境变量。\n\n第二行`Defaults        mail_badpass`表示回发邮件（默认是root）提示用户使用了badpass。\n\n第三行`Defaults        secure_path=`表示sudo操作使用时的`PATH`环境变量。\n\n* `root` ALL=(ALL:ALL) ALL\n\n第一个字段表示允许使用sudo的用户，如果使用%开头则表示用户组。\n\n* root `ALL`=(ALL:ALL) ALL\n\n第一个ALL表示可以在所有主机上使用。\n\n* root ALL=(`ALL`:ALL) ALL\n\n这个ALL表示可以以任意用户身执行命令。\n\n* root ALL=(ALL:`ALL`) ALL\n\n这个ALL表示可以使用任意用户组身份来执行命令。\n\n* root ALL=(ALL:ALL) `ALL`\n\n最后一个ALL表示可以执行所有命令，可以添加前缀`NOPASSWD:` 表示不需要验证密码。如：\n`Jonathan    ALL=(ALL:ALL)    NOPASSWD:ALL`\n\n\n最后一行`#includedir /etc/sudoers.d`表示会读取所有在`/etc/sudoers.d`目录下的配置（开头的#并不是说这个是注释）。\n\n\n#### 使用别名\n\n可通过定义别名来简化配置\n\n主机别名：\n\n```sudoers\nHost_Alias     MAILSERVERS = smtp, smtp2\n```\n\n用户别名：\n\n```sudoers\nUser_Alias ADMINS = jsmith, mikem\n```\n\n命令别名：\n多条命令使用`,`分割\n```\nCmnd_Alias PROCESSES = /bin/nice, /bin/kill, /usr/bin/kill, /usr/bin/killall\n```\n\n\n### 危险⚠️\n\n注意⚠️： 如果操作系统没有root账户，编辑sudoers文件中出现格式错误，会导致所有sudoers用户无法使用sudo权限，系统无法被管理。\n\n","date":"2021-12-08","id":61,"slug":"use-sudoers-file","title":"使用sudoers文件"},"lightCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#c18401}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}","darkCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#e6c07b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}"},"__N_SSG":true}