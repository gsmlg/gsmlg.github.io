{"pageProps":{"slug":"move-alias-from-webpack-to-babel","blog":{"author":"Gao","content":"昨天给项目添加单元测试，发现`import`有大量的 missing\n\n检查返现问题：\n\n1. webpack 中有大量的`alias`导致\n2. webpack 中有`define plugin`，导致全局变量丢失\n3. webpack 中有`provide plugin`，导致一些没有被引入的变量出错\n\n进过一番调研，决定使用如下解决方式：\n\n使用 Babel 的 module resolver plugin 来处理这个问题\n\n所以，对整个项目做了一些调整\n\n将原先的`.babelrc`文件更换为`babel.config.js`\n\n添加 babel 插件`babel-plugin-module-resolver`,并将原先的 webpack 别名修改过来\n\n删除了 webpack 的 alias，添加了如下内容到 babel.config.js，由于路径会和 webpack\n相互交互，为了方便处理，所以使用了绝对路径\n\n```js\nplugins: [\n  [\n    'module-resolver',\n    {\n      root: [rootPath, path.join(rootPath, '/assets/javascripts')],\n      alias: {\n        plugins: path.join(zddiRoot, 'zddi/common/plugins'),\n        eve: path.join(zddiRoot, 'zddi/common/plugins/eve-raphael'),\n        raphael: path.join(zddiRoot, 'zddi/common/plugins/raphael/raphael.amd'),\n        i18n: `${zddiRoot}/i18n/i18n-data`,\n        common: path.join(zddiRoot, 'zddi/common'),\n        models: path.join(zddiRoot, 'zddi/common/models'),\n        views: path.join(zddiRoot, 'zddi/common/views'),\n        controller: path.join(zddiRoot, 'zddi/common/controller'),\n        utils: path.join(zddiRoot, 'zddi/common/utils'),\n        dashboard: path.join(zddiRoot, 'zddi/dashboard'),\n        address: path.join(zddiRoot, 'zddi/address'),\n        cloud: path.join(zddiRoot, 'zddi/cloud'),\n        am: path.join(zddiRoot, 'zddi/am'),\n        dns: path.join(zddiRoot, 'zddi/dns'),\n        secure: path.join(zddiRoot, 'zddi/secure'),\n        system: path.join(zddiRoot, 'zddi/system'),\n        jquery: path.join(zddiRoot, 'zddi/common/plugins/jquery'),\n        cell: path.join(zddiRoot, 'zddi/common/components/table/index'),\n      },\n    },\n  ],\n];\n```\n\n修改完成后发现问题，原先的 define plugin 的导入出了错误。原因是由于 template\nloader 没有用 babel 处理导致的，为了方便，我改了 provide plugin 的引入点，做了路\n径指向\n\n提交时发现问题，eslint 无法通过\n\n于是做了修改，增加了两个插件\n\n- `eslint-plugin-jest`\n- `eslint-import-resolver-babel-module`\n\n修改配置后支持 jest 全局变量和使用 babel module resolver 来检查当前的包含关系\n","date":"2020-04-09","id":35,"slug":"move-alias-from-webpack-to-babel","title":"使用Babel的来代替webpack别名"},"lightCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#c18401}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}","darkCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#e6c07b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}"},"__N_SSG":true}