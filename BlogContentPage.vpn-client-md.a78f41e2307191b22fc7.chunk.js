(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"11023f0c6075940f97ec":function(s,n){s.exports="<h1 id=\u5728linux\u7cfb\u7edf\u4e2d\u914d\u7f6evpn-client>\u5728Linux\u7cfb\u7edf\u4e2d\u914d\u7f6eVPN Client</h1> <p>\u5728\u6ca1\u6709X\u7684linux\u7cfb\u7edf\u4e2d\u5b89\u88c5\u542f\u7528VPN</p> <h2 id=\u5b89\u88c5>\u5b89\u88c5</h2> <pre class=hljs><code class=language-shell><span class=hljs-meta>#</span><span class=bash> Ubuntu &amp; Debian</span>\napt-get update\napt-get -y install strongswan xl2tpd\n<span class=hljs-meta>\n#</span><span class=bash> CentOS &amp; RHEL</span>\nyum -y install epel-release\nyum --enablerepo=epel -y install strongswan xl2tpd\n<span class=hljs-meta>\n#</span><span class=bash> Fedora</span>\nyum -y install strongswan xl2tpd</code></pre><h3 id=\u914d\u7f6evpn\u8d26\u6237>\u914d\u7f6eVPN\u8d26\u6237</h3> <pre class=hljs><code class=language-shell>VPN_SERVER_IP='\u4f60\u7684VPN\u670d\u52a1\u5668IP'\nVPN_IPSEC_PSK='\u4f60\u7684IPsec\u9884\u5171\u4eab\u5bc6\u94a5'\nVPN_USER='\u4f60\u7684VPN\u7528\u6237\u540d'\nVPN_PASSWORD='\u4f60\u7684VPN\u5bc6\u7801'</code></pre><h3 id=\u914d\u7f6estrongswan>\u914d\u7f6eStrongswan</h3> <pre class=hljs><code class=language-shell>cat &gt; /etc/ipsec.conf &lt;&lt;EOF\n<span class=hljs-meta>#</span><span class=bash> ipsec.conf - strongSwan IPsec configuration file</span>\n<span class=hljs-meta>\n#</span><span class=bash> basic configuration</span>\n\nconfig setup\n<span class=hljs-meta>  #</span><span class=bash> strictcrlpolicy=yes</span>\n<span class=hljs-meta>  #</span><span class=bash> uniqueids = no</span>\n<span class=hljs-meta>\n#</span><span class=bash> Add connections here.</span>\n<span class=hljs-meta>\n#</span><span class=bash> Sample VPN connections</span>\n\nconn %default\n  ikelifetime=60m\n  keylife=20m\n  rekeymargin=3m\n  keyingtries=1\n  keyexchange=ikev1\n  authby=secret\n  ike=aes128-sha1-modp1024,3des-sha1-modp1024!\n  esp=aes128-sha1-modp1024,3des-sha1-modp1024!\n\nconn myvpn\n  keyexchange=ikev1\n  left=%defaultroute\n  auto=add\n  authby=secret\n  type=transport\n  leftprotoport=17/1701\n  rightprotoport=17/1701\n  right=$VPN_SERVER_IP\nEOF\n\ncat &gt; /etc/ipsec.secrets &lt;&lt;EOF\n: PSK \"$VPN_IPSEC_PSK\"\nEOF\n\nchmod 600 /etc/ipsec.secrets\n<span class=hljs-meta>\n#</span><span class=bash> For CentOS/RHEL &amp; Fedora ONLY</span>\nmv /etc/strongswan/ipsec.conf /etc/strongswan/ipsec.conf.old 2&gt;/dev/null\nmv /etc/strongswan/ipsec.secrets /etc/strongswan/ipsec.secrets.old 2&gt;/dev/null\nln -s /etc/ipsec.conf /etc/strongswan/ipsec.conf\nln -s /etc/ipsec.secrets /etc/strongswan/ipsec.secrets</code></pre><h3 id=\u914d\u7f6e-xl2tpd>\u914d\u7f6e xl2tpd</h3> <pre class=hljs><code class=language-shell>cat &gt; /etc/xl2tpd/xl2tpd.conf &lt;&lt;EOF\n[lac myvpn]\nlns = $VPN_SERVER_IP\nppp debug = yes\npppoptfile = /etc/ppp/options.l2tpd.client\nlength bit = yes\nEOF\n\ncat &gt; /etc/ppp/options.l2tpd.client &lt;&lt;EOF\nipcp-accept-local\nipcp-accept-remote\nrefuse-eap\nrequire-chap\nnoccp\nnoauth\nmtu 1280\nmru 1280\nnoipdefault\ndefaultroute\nusepeerdns\nconnect-delay 5000\nname $VPN_USER\npassword $VPN_PASSWORD\nEOF\n\nchmod 600 /etc/ppp/options.l2tpd.client</code></pre><ul> <li>\u81f3\u6b64 VPN \u5ba2\u6237\u7aef\u914d\u7f6e\u5df2\u5b8c\u6210</li> </ul> <h2 id=\u914d\u7f6e\u8fde\u63a5>\u914d\u7f6e\u8fde\u63a5</h2> <h3 id=\u521b\u5efa-xl2tpd-\u63a7\u5236\u6587\u4ef6\uff1a>\u521b\u5efa xl2tpd \u63a7\u5236\u6587\u4ef6\uff1a</h3> <pre class=hljs><code class=language-shell>mkdir -p /var/run/xl2tpd\ntouch /var/run/xl2tpd/l2tp-control</code></pre><h3 id=\u91cd\u542f\u670d\u52a1\uff1a>\u91cd\u542f\u670d\u52a1\uff1a</h3> <pre class=hljs><code class=language->service strongswan restart\nservice xl2tpd restart\n```\n\n<span class=hljs-comment>### \u5f00\u59cb IPsec \u8fde\u63a5\uff1a</span>\n\n```shell\n<span class=hljs-comment># Ubuntu &amp; Debian</span>\nipsec up myvpn\n\n<span class=hljs-comment># CentOS/RHEL &amp; Fedora</span>\nstrongswan up myvpn\n```\n\n<span class=hljs-comment>### \u5f00\u59cb L2TP \u8fde\u63a5\uff1a</span>\n\n```shell\necho <span class=hljs-string>\"c myvpn\"</span> &gt; <span class=hljs-regexp>/var/</span>run<span class=hljs-regexp>/xl2tpd/</span>l2tp-control\n```\n\n<span class=hljs-comment>## \u914d\u7f6e\u8def\u7531</span>\n\n\u67e5\u770b\u8def\u7531\n\n```shell\nip route\n```\n\n\u521b\u5efa\u8def\u7531\u8868\n\n```\ngit clone https:<span class=hljs-regexp>//gi</span>thub.com<span class=hljs-regexp>/gsmlg/</span>static-routes.git\ncd static-routes\nmake linux\n<span class=hljs-comment># mode 1 \u4e0d\u9700\u8981\u4fee\u6539 default route</span>\n\\cp mode1<span class=hljs-regexp>/ip-up /</span>etc<span class=hljs-regexp>/ppp/i</span>p-up.local\n<span class=hljs-comment># mode 2 \u9700\u8981\u914d\u7f6e default route \u5230VPN\u7684IP</span>\n\\cp mode1<span class=hljs-regexp>/ip-up /</span>etc<span class=hljs-regexp>/ppp/i</span>p-up.local\n\\cp mode1<span class=hljs-regexp>/ip-down /</span>etc<span class=hljs-regexp>/ppp/i</span>p-down\n\n```\n\n<span class=hljs-comment>## \u65ad\u5f00\u8fde\u63a5</span>\n\n```\n<span class=hljs-comment># Ubuntu &amp; Debian</span>\necho <span class=hljs-string>\"d myvpn\"</span> &gt; <span class=hljs-regexp>/var/</span>run<span class=hljs-regexp>/xl2tpd/</span>l2tp-control\nipsec down myvpn\n\n<span class=hljs-comment># CentOS/RHEL &amp; Fedora</span>\necho <span class=hljs-string>\"d myvpn\"</span> &gt; <span class=hljs-regexp>/var/</span>run<span class=hljs-regexp>/xl2tpd/</span>l2tp-control\nstrongswan down myvpn\n```</code></pre>"}}]);