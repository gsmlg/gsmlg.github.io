(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"9d44caf3051d7a65a90b":function(e,s){e.exports='<h2 id=\u5728kubernetes\u4e2d\u5b89\u88c5jenkins>\u5728Kubernetes\u4e2d\u5b89\u88c5jenkins</h2> <h3 id=\u7b80\u4ecb>\u7b80\u4ecb</h3> <p>\u5728kubernetes\u4e2d\u5b89\u88c5Jenkins Jenkins \u4f1a\u4ee5 master \u65b9\u5f0f\u8fd0\u884c\uff0c\u5f53\u6709build\u4efb\u52a1\u65f6\uff0c\u4f1a\u5728kubernetes\u4e2d\u542f\u52a8\u4e00\u4e2apod\u6765\u8fd0\u884c\u5bf9\u5e94\u7684\u6784\u5efa\u4efb\u52a1 \u9700\u8981\u914d\u7f6e\u5bf9\u5e94\u7684pod\u6765\u89e3\u51b3\u5e38\u89c4\u7684\u6784\u5efa\u95ee\u9898</p> <h3 id=\u5b89\u88c5jeknis\u5230kubernetes\uff1a>\u5b89\u88c5Jeknis\u5230Kubernetes\uff1a</h3> <pre class=hljs><code class="language-undefined">\u4f7f\u7528\u4ed3\u5e93 https:<span class=hljs-regexp>//gi</span>thub.com<span class=hljs-regexp>/gsmlg/</span>jenkins \u4e2d\u7684\u914d\u7f6e</code></pre><ol> <li><p>\u914d\u7f6eDeployment \u4f7f\u7528 deployment.yaml</p> <pre class=hljs><code class=language-><span class=hljs-selector-tag>kubectl</span> <span class=hljs-selector-tag>create</span> <span class=hljs-selector-tag>-f</span> <span class=hljs-selector-tag>deployment</span><span class=hljs-selector-class>.yaml</span></code></pre></li> <li><p>\u914d\u7f6eservice.yaml \u4f7f\u7528 service.yaml</p> <pre class=hljs><code class=language-><span class=hljs-selector-tag>kubectl</span> <span class=hljs-selector-tag>create</span> <span class=hljs-selector-tag>-f</span> <span class=hljs-selector-tag>service</span><span class=hljs-selector-class>.yaml</span></code></pre></li> <li><p>\u624b\u52a8\u6dfb\u52a0ingress\u914d\u7f6e \u4f7f\u7528<code>rancher</code>\u914d\u7f6eingress\u670d\u52a1</p> </li> </ol> <h3 id=\u5bf9jenkins\u8fdb\u884c\u914d\u7f6e>\u5bf9jenkins\u8fdb\u884c\u914d\u7f6e</h3> <ol> <li><p>\u5728 configure global security \u4e2d\u53ef\u4ee5\u914d\u7f6e\u7528\u6237\uff0c\u7528\u4e8e\u767b\u9646\u7ba1\u7406</p> </li> <li><p>\u914d\u7f6e\u8fde\u63a5kubernetes\u7684\u6743\u9650</p> <ul> <li>\u5728 configure system \u4e2d\uff0c\u914d\u7f6e</li> </ul> </li> </ol> <p>\u6dfb\u52a0cloud\u914d\u7f6e</p> <ul> <li><p>\u914d\u7f6e <code>kubernetes URL</code> \u4e3a <code>API server</code> \u7684\u5730\u5740</p> </li> <li><p>\u5728 <code>Credentials</code> \u914d\u7f6e\u4e0a\u914d\u7f6e <code>kubeconfig</code></p> </li> <li><p>\u6dfb\u52a0<code>Jenkins tunnel</code> \u5730\u5740\uff0c\u5730\u5740\u4e3a<code>service</code>\u914d\u7f6e\u4e2d\u7684 <code>jenkins-jnlp</code> \u7684\u5730\u5740</p> </li> <li><p>\u914d\u7f6e<code>Kubenetes Pod Template</code>\uff0c <code>labels</code> \u914d\u7f6e\u7528\u4e8e<code>slave</code>\u542f\u52a8\u65f6\u6dfb\u52a0\u7684\u914d\u7f6e</p> </li> <li><p>\u914d\u7f6e<code>contaienr</code>\u53c2\u7167\u9700\u6c42\u914d\u7f6e</p> <p> \u8bb0\u5f55\u4e0b\u914d\u7f6e\u7684Labels</p> <p> \u5220\u9664 command to run\uff0c Arguments to pass to the command \u914d\u7f6e</p> <p> dind\u914d\u7f6e\u9700\u8981\u6dfb\u52a0volume\u6620\u5c04docker.sock</p> <pre class=hljs><code class="language-undefined">  contaienr\u955c\u50cf\u5f53\u524d\u9700\u8981\u81ea\u5df1\u914d\u7f6e\uff0c\u76ee\u524d\u5df2\u7ecf\u505a\u4e86\u4e24\u4e2a\u955c\u50cf\n  - gsmlg/jenkins-<span class=hljs-literal>slave</span>-jnlp-dind\n  - gsmlg/jenkins-<span class=hljs-literal>slave</span>-jnlp-nodejs</code></pre></li> </ul> <h3 id=\u914d\u7f6e\u9879\u76ee>\u914d\u7f6e\u9879\u76ee</h3> <p>\u6dfb\u52a0<code>project</code>\u7684\u65f6\u5019</p> <ul> <li><p>\u901a\u8fc7 <code>Label Expression</code> \u6765\u786e\u5b9a\u4f7f\u7528\u54ea\u4e00\u4e2a<code>Pod template</code> \u6765\u542f\u52a8 <code>slave</code></p> </li> <li><p><code>Source Code Management</code> \u914d\u7f6egit\u9879\u76ee\u5730\u5740 </p> </li> <li><p><code>branches to build</code> \u6307\u5b9a\u90a3\u4e9b\u5206\u652f\u4f1a\u8fdb\u884c\u6784\u5efa</p> </li> <li><p><code>Build Triggers</code> \u4e2d\u6307\u5b9a\u81ea\u52a8\u51fa\u53d1build\u7684\u89e6\u53d1\u5668</p> </li> <li><p><code>Build Environment</code> \u6307\u5b9aBuild\u7ec8\u7aef\u8f93\u51fa\u989c\u8272</p> </li> <li><p><code>Build</code> \u6307\u5b9abuild\u547d\u4ee4\uff0c\u53ef\u4ee5\u5206\u9636\u6bb5\u6267\u884c</p> </li> <li><p><code>Post build</code> build\u5b8c\u6210\u540e\u7684\u52a8\u4f5c</p> </li> </ul> <h2 id=comment>Comment</h2> <ul> <li>jnlp - Java Network Launch Protocol <a href=https://docs.oracle.com/javase/tutorial/deployment/deploymentInDepth/jnlp.html>Link</a></li> </ul> '}}]);