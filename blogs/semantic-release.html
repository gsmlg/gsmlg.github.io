<!DOCTYPE html><html lang="en"><head><meta name="theme-color" content="#1976d2"/><meta charSet="utf-8"/><meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width"/><meta name="theme-color" content="#1976d2"/><title>语义化版本发布</title><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/e48649c78aa55d60.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e48649c78aa55d60.css" data-n-g=""/><link rel="preload" href="/_next/static/css/c2a527101433f11d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c2a527101433f11d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-1fec710eb11e1257.js" defer=""></script><script src="/_next/static/chunks/framework-0f8b31729833af61.js" defer=""></script><script src="/_next/static/chunks/main-e7f9cd3517807e31.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7825d72700eb2480.js" defer=""></script><script src="/_next/static/chunks/947-989f03f09a3cc71b.js" defer=""></script><script src="/_next/static/chunks/730-1c76b0ab25789650.js" defer=""></script><script src="/_next/static/chunks/pages/blogs/%5Bslug%5D-0fc661ed1e1d61c5.js" defer=""></script><script src="/_next/static/HMCjgee_YAXnCP6s2jMGQ/_buildManifest.js" defer=""></script><script src="/_next/static/HMCjgee_YAXnCP6s2jMGQ/_ssgManifest.js" defer=""></script><script src="/_next/static/HMCjgee_YAXnCP6s2jMGQ/_middlewareManifest.js" defer=""></script><style data-emotion="css "></style></head><body><div id="__next"><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><section class="css-1vqbnt3"><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-1x7skt0"><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-191lty2"><div status="[object Object]" class="css-ad3hhb"></div><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeLarge css-1l1167e" tabindex="0" type="button" aria-label="Menu"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" viewBox="0 0 24 24" aria-hidden="true" data-testid="MenuIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button><p class="MuiTypography-root MuiTypography-body1 css-1ikde92" type="title"><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/">Home</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/blogs">Blog</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/presentations">Presentation</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/tools">Tool</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/games">Game</a></button></p></div></header><section class="css-xxwux"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation4 css-gnirli"><header><h1 class="MuiTypography-root MuiTypography-body1 css-9l3uo3">语义化版本发布</h1><div class="MuiTypography-root MuiTypography-body1 css-9l3uo3">Author:<!-- -->Gao</div><div class="MuiTypography-root MuiTypography-body1 css-9l3uo3">Created At:<!-- -->2021-02-25</div></header><hr class="MuiDivider-root MuiDivider-fullWidth css-39bbo6"/><section class="MuiTypography-root MuiTypography-body1 blog-content css-9l3uo3"><div class="css-1xqzmcn"><h1>Using semantic release</h1>
<p>在介绍<code>semantic release</code>之前, 首先介绍<code>semantic versioning</code></p>
<h2>Semantic Versioning</h2>
<p>语义化版本 <a href="https://semver.org">链接</a></p>
<h3>摘要</h3>
<p>版本格式：主版本号.次版本号.修订号，版本号递增规则如下：</p>
<ol>
<li>主版本号：当你做了不兼容的 API 修改，</li>
<li>次版本号：当你做了向下兼容的功能性新增，</li>
<li>修订号：当你做了向下兼容的问题修正。先行版本号及版本编译元数据可以加到“主版本
号.次版本号.修订号”的后面，作为延伸。</li>
</ol>
<h3>简介</h3>
<p>在软件管理的领域里存在着被称作“依赖地狱”的死亡之谷，系统规模越大，加入的包越多，
你就越有可能在未来的某一天发现自己已深陷绝望之中。在依赖高的系统中发布新版本包可
能很快会成为噩梦。如果依赖关系过高，可能面临版本控制被锁死的风险（必须对每一个依
赖包改版才能完成某次升级）。而如果依赖关系过于松散，又将无法避免版本的混乱（假设
兼容于未来的多个版本已超出了合理数量）。当你专案的进展因为版本依赖被锁死或版本混
乱变得不够简便和可靠，就意味着你正处于依赖地狱之中。作为这个问题的解决方案之一，
我提议用一组简单的规则及条件来约束版本号的配置和增长。这些规则是根据（但不局限于
）已经被各种封闭、开放源码软件所广泛使用的惯例所设计。为了让这套理论运作，你必须
先有定义好的公共 API 。这可以透过文件定义或代码强制要求来实现。无论如何，这套
API 的清楚明了是十分重要的。一旦你定义了公共 API，你就可以透过修改相应的版本号来
向大家说明你的修改。考虑使用这样的版本号格式：X.Y.Z （主版本号.次版本号.修订号）
修复问题但不影响 API 时，递增修订号；API 保持向下兼容的新增及修改时，递增次版本
号；进行不向下兼容的修改时，递增主版本号。我称这套系统为“语义化的版本控制”，在这
套约定下，版本号及其更新方式包含了相邻版本间的底层代码和修改内容的信息。</p>
<h3>为什么要使用语义化的版本控制？</h3>
<p>这并不是一个新的或者革命性的想法。实际上，你可能已经在做一些近似的事情了。问题在
于只是“近似”还不够。如果没有某个正式的规范可循，版本号对于依赖的管理并无实质意义
。将上述的想法命名并给予清楚的定义，让你对软件使用者传达意向变得容易。一旦这些意
向变得清楚，弹性（但又不会太弹性）的依赖规范就能达成。举个简单的例子就可以展示语
义化的版本控制如何让依赖地狱成为过去。假设有个名为“救火车”的函式库，它需要另一个
名为“梯子”并已经有使用语义化版本控制的包。当救火车创建时，梯子的版本号为 3.1.0。
因为救火车使用了一些版本 3.1.0 所新增的功能， 你可以放心地指定依赖于梯子的版本号
大等于 3.1.0 但小于 4.0.0。这样，当梯子版本 3.1.1 和 3.2.0 发布时，你可以将直接
它们纳入你的包管理系统，因为它们能与原有依赖的软件兼容。作为一位负责任的开发者，
你理当确保每次包升级的运作与版本号的表述一致。现实世界是复杂的，我们除了提高警觉
外能做的不多。你所能做的就是让语义化的版本控制为你提供一个健全的方式来发行以及升
级包，而无需推出新的依赖包，节省你的时间及烦恼。如果你对此认同，希望立即开始使用
语义化版本控制，你只需声明你的函式库正在使用它并遵循这些规则就可以了。请在你的
README 文件中保留此页连结，让别人也知道这些规则并从中受益。</p>
<h2>Semantic Release</h2>
<p>Semantic release, 中文大意是语义发布, 作用是实现完全自动化的版本管理和发布.</p>
<p><code>Semantic-release</code> 会自动完成整个发布流程, 包括: 自动查明下一个版本号, 生成
release note 和 进行包的发布.</p>
<p>这消除了人类情感和版本号之间的直接联系, 严格的遵循<code>Semantic Versioning</code> 规范.</p>
<p><img src="semantic-release/kill-all-humans.png" alt="kill-all-humans"/></p>
<h3>亮点</h3>
<ul>
<li>完全自动发布</li>
<li>确保语义版本(Semantic Versioning)规范</li>
<li>新特性和修复可以立即对用户可用</li>
<li>提醒维护者和用户新的发布</li>
<li>在代码库中使用格式化的提交信息变化并生成文档</li>
<li>基于 git merges 可以创建不同的发布频道</li>
<li>和 CI 工作流集成</li>
<li>和手动发布相比避免潜在的说明错误</li>
<li>经由插件支持任何版本能管理和语言</li>
<li>使用<code>共享配置(shareable configurations)</code>来方便和复用配置</li>
</ul>
<h3>How it works?</h3>
<h4>提交信息格式 (commit message format)</h4>
<p><code>Semantic Release</code>使用用户提交信息(commit message) 查出更新变化的类型. 通过
commit message 的格式约定, semantic-release 自动查出下一个 semantic version 版本
号, 生成更新日志并发布版本.</p>
<p>Semantic-release 默认使用 Angular Commit message conventions. 提交信息格式可以通
过修
改<code>@semantic-release/commit-analyzer</code>和<code>@semantic-release/release-notes-generator</code>的<code>preset</code>和<code>config</code>选
项来改变.</p>
<p>通过像 commitzen 和 commitlint 之类的工具可以帮助确保验证提交信息符合约定.</p>
<p>提交示例:</p>
<pre><code class="hljs language-markdown">fix(pencil): stop graphite breaking when too much pressure applied Patch Release
feat(pencil): add &#x27;graphiteWidth&#x27; option Minor Feature Release perf(pencil):
remove graphiteWidth option Major Breaking Release

BREAKING CHANGE: The graphiteWidth option has been removed. The default graphite
width of 10mm is always used for performance reasons.
</code></pre>
<h3>现实中的项目示例</h3>
<pre><code class="hljs language-yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">nodejs-scripts-validate-and-release</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">paths:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;nodejs/packages/scripts/**&#x27;</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;.github/workflows/nodejs-scripts-validate-and-release.yml&#x27;</span>
    <span class="hljs-attr">branches:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;+([0-9])?(.{+([0-9]),x}).x&#x27;</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;master&#x27;</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;next&#x27;</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;next-major&#x27;</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;beta&#x27;</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;alpha&#x27;</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;!all-contributors/**&#x27;</span>
  <span class="hljs-attr">pull_request:</span> {}
<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">main:</span>
    <span class="hljs-comment"># ignore all-contributors PRs</span>
    <span class="hljs-attr">if:</span> <span class="hljs-string">${{</span> <span class="hljs-type">!contains(github.head_ref,</span> <span class="hljs-string">&#x27;all-contributors&#x27;</span><span class="hljs-string">)</span> <span class="hljs-string">}}</span>
    <span class="hljs-attr">strategy:</span>
      <span class="hljs-attr">matrix:</span>
        <span class="hljs-attr">os:</span> [<span class="hljs-string">ubuntu-latest</span>, <span class="hljs-string">macos-latest</span>]
        <span class="hljs-attr">node:</span> [<span class="hljs-number">12</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>]
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">${{</span> <span class="hljs-string">matrix.os</span> <span class="hljs-string">}}</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">🛑</span> <span class="hljs-string">Cancel</span> <span class="hljs-string">Previous</span> <span class="hljs-string">Runs</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">styfle/cancel-workflow-action@0.6.0</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">access_token:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">}}</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">⬇️</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">repo</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">⎔</span> <span class="hljs-string">Setup</span> <span class="hljs-string">node</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-string">${{</span> <span class="hljs-string">matrix.node</span> <span class="hljs-string">}}</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">📥</span> <span class="hljs-string">Download</span> <span class="hljs-string">deps</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">bahmutov/npm-install@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">useLockFile:</span> <span class="hljs-literal">false</span>
          <span class="hljs-attr">working-directory:</span> <span class="hljs-string">&#x27;nodejs/packages/scripts&#x27;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">▶️</span> <span class="hljs-string">Run</span> <span class="hljs-string">validate</span> <span class="hljs-string">script</span>
        <span class="hljs-attr">working-directory:</span> <span class="hljs-string">&#x27;nodejs/packages/scripts&#x27;</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">validate</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">⬆️</span> <span class="hljs-string">Upload</span> <span class="hljs-string">coverage</span> <span class="hljs-string">report</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">codecov/codecov-action@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">directory:</span> <span class="hljs-string">&#x27;nodejs/packages/scripts/coverage/&#x27;</span>

  <span class="hljs-attr">release:</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">main</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">if:</span>
      <span class="hljs-string">${{</span> <span class="hljs-string">github.repository</span> <span class="hljs-string">==</span> <span class="hljs-string">&#x27;gsmlg-dev/Foundation&#x27;</span> <span class="hljs-string">&amp;&amp;</span>
      <span class="hljs-string">contains(&#x27;refs/heads/master,refs/heads/beta,refs/heads/next,refs/heads/alpha&#x27;,</span>
      <span class="hljs-string">github.ref)</span> <span class="hljs-string">&amp;&amp;</span> <span class="hljs-string">github.event_name</span> <span class="hljs-string">==</span> <span class="hljs-string">&#x27;push&#x27;</span> <span class="hljs-string">}}</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">🛑</span> <span class="hljs-string">Cancel</span> <span class="hljs-string">Previous</span> <span class="hljs-string">Runs</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">styfle/cancel-workflow-action@0.6.0</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">access_token:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">}}</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">⬇️</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">repo</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">⎔</span> <span class="hljs-string">Setup</span> <span class="hljs-string">node</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-number">14</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">📥</span> <span class="hljs-string">Download</span> <span class="hljs-string">deps</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">bahmutov/npm-install@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">useLockFile:</span> <span class="hljs-literal">false</span>
          <span class="hljs-attr">working-directory:</span> <span class="hljs-string">&#x27;nodejs/packages/scripts&#x27;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">🏗</span> <span class="hljs-string">Run</span> <span class="hljs-string">build</span> <span class="hljs-string">script</span>
        <span class="hljs-attr">working-directory:</span> <span class="hljs-string">&#x27;nodejs/packages/scripts&#x27;</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">🚀</span> <span class="hljs-string">Release</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">gsmlg/semantic-release-action@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">working-directory:</span> <span class="hljs-string">&#x27;nodejs/packages/scripts&#x27;</span>
          <span class="hljs-attr">semantic_version:</span> <span class="hljs-number">17</span>
          <span class="hljs-attr">branches:</span> <span class="hljs-string">|
            [
              &#x27;+([0-9])?(.{+([0-9]),x}).x&#x27;,
              &#x27;master&#x27;,
              &#x27;next&#x27;,
              &#x27;next-major&#x27;,
              {name: &#x27;beta&#x27;, prerelease: true},
              {name: &#x27;alpha&#x27;, prerelease: true}
            ]
</span>        <span class="hljs-attr">env:</span>
          <span class="hljs-attr">GITHUB_TOKEN:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">NPM_TOKEN:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.NPM_TOKEN</span> <span class="hljs-string">}}</span>
</code></pre></div></section></div></section><footer style="margin-top:0" class="css-6haedj"><div class="container"><span id="icp-info" class="css-z2a085">京ICP备20014476号-2</span><span>Copyright © 2017-2021 GSMLG - Powered by GSMLG Web.</span></div></footer></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"semantic-release","blog":{"author":"Gao","content":"# Using semantic release\n\n在介绍`semantic release`之前, 首先介绍`semantic versioning`\n\n## Semantic Versioning\n\n语义化版本 [链接](https://semver.org)\n\n### 摘要\n\n版本格式：主版本号.次版本号.修订号，版本号递增规则如下：\n\n1. 主版本号：当你做了不兼容的 API 修改，\n2. 次版本号：当你做了向下兼容的功能性新增，\n3. 修订号：当你做了向下兼容的问题修正。先行版本号及版本编译元数据可以加到“主版本\n   号.次版本号.修订号”的后面，作为延伸。\n\n### 简介\n\n在软件管理的领域里存在着被称作“依赖地狱”的死亡之谷，系统规模越大，加入的包越多，\n你就越有可能在未来的某一天发现自己已深陷绝望之中。在依赖高的系统中发布新版本包可\n能很快会成为噩梦。如果依赖关系过高，可能面临版本控制被锁死的风险（必须对每一个依\n赖包改版才能完成某次升级）。而如果依赖关系过于松散，又将无法避免版本的混乱（假设\n兼容于未来的多个版本已超出了合理数量）。当你专案的进展因为版本依赖被锁死或版本混\n乱变得不够简便和可靠，就意味着你正处于依赖地狱之中。作为这个问题的解决方案之一，\n我提议用一组简单的规则及条件来约束版本号的配置和增长。这些规则是根据（但不局限于\n）已经被各种封闭、开放源码软件所广泛使用的惯例所设计。为了让这套理论运作，你必须\n先有定义好的公共 API 。这可以透过文件定义或代码强制要求来实现。无论如何，这套\nAPI 的清楚明了是十分重要的。一旦你定义了公共 API，你就可以透过修改相应的版本号来\n向大家说明你的修改。考虑使用这样的版本号格式：X.Y.Z （主版本号.次版本号.修订号）\n修复问题但不影响 API 时，递增修订号；API 保持向下兼容的新增及修改时，递增次版本\n号；进行不向下兼容的修改时，递增主版本号。我称这套系统为“语义化的版本控制”，在这\n套约定下，版本号及其更新方式包含了相邻版本间的底层代码和修改内容的信息。\n\n### 为什么要使用语义化的版本控制？\n\n这并不是一个新的或者革命性的想法。实际上，你可能已经在做一些近似的事情了。问题在\n于只是“近似”还不够。如果没有某个正式的规范可循，版本号对于依赖的管理并无实质意义\n。将上述的想法命名并给予清楚的定义，让你对软件使用者传达意向变得容易。一旦这些意\n向变得清楚，弹性（但又不会太弹性）的依赖规范就能达成。举个简单的例子就可以展示语\n义化的版本控制如何让依赖地狱成为过去。假设有个名为“救火车”的函式库，它需要另一个\n名为“梯子”并已经有使用语义化版本控制的包。当救火车创建时，梯子的版本号为 3.1.0。\n因为救火车使用了一些版本 3.1.0 所新增的功能， 你可以放心地指定依赖于梯子的版本号\n大等于 3.1.0 但小于 4.0.0。这样，当梯子版本 3.1.1 和 3.2.0 发布时，你可以将直接\n它们纳入你的包管理系统，因为它们能与原有依赖的软件兼容。作为一位负责任的开发者，\n你理当确保每次包升级的运作与版本号的表述一致。现实世界是复杂的，我们除了提高警觉\n外能做的不多。你所能做的就是让语义化的版本控制为你提供一个健全的方式来发行以及升\n级包，而无需推出新的依赖包，节省你的时间及烦恼。如果你对此认同，希望立即开始使用\n语义化版本控制，你只需声明你的函式库正在使用它并遵循这些规则就可以了。请在你的\nREADME 文件中保留此页连结，让别人也知道这些规则并从中受益。\n\n## Semantic Release\n\nSemantic release, 中文大意是语义发布, 作用是实现完全自动化的版本管理和发布.\n\n`Semantic-release` 会自动完成整个发布流程, 包括: 自动查明下一个版本号, 生成\nrelease note 和 进行包的发布.\n\n这消除了人类情感和版本号之间的直接联系, 严格的遵循`Semantic Versioning` 规范.\n\n![kill-all-humans](semantic-release/kill-all-humans.png)\n\n### 亮点\n\n- 完全自动发布\n- 确保语义版本(Semantic Versioning)规范\n- 新特性和修复可以立即对用户可用\n- 提醒维护者和用户新的发布\n- 在代码库中使用格式化的提交信息变化并生成文档\n- 基于 git merges 可以创建不同的发布频道\n- 和 CI 工作流集成\n- 和手动发布相比避免潜在的说明错误\n- 经由插件支持任何版本能管理和语言\n- 使用`共享配置(shareable configurations)`来方便和复用配置\n\n### How it works?\n\n#### 提交信息格式 (commit message format)\n\n`Semantic Release`使用用户提交信息(commit message) 查出更新变化的类型. 通过\ncommit message 的格式约定, semantic-release 自动查出下一个 semantic version 版本\n号, 生成更新日志并发布版本.\n\nSemantic-release 默认使用 Angular Commit message conventions. 提交信息格式可以通\n过修\n改`@semantic-release/commit-analyzer`和`@semantic-release/release-notes-generator`的`preset`和`config`选\n项来改变.\n\n通过像 commitzen 和 commitlint 之类的工具可以帮助确保验证提交信息符合约定.\n\n提交示例:\n\n```markdown\nfix(pencil): stop graphite breaking when too much pressure applied Patch Release\nfeat(pencil): add 'graphiteWidth' option Minor Feature Release perf(pencil):\nremove graphiteWidth option Major Breaking Release\n\nBREAKING CHANGE: The graphiteWidth option has been removed. The default graphite\nwidth of 10mm is always used for performance reasons.\n```\n\n### 现实中的项目示例\n\n```yaml\nname: nodejs-scripts-validate-and-release\non:\n  push:\n    paths:\n      - 'nodejs/packages/scripts/**'\n      - '.github/workflows/nodejs-scripts-validate-and-release.yml'\n    branches:\n      - '+([0-9])?(.{+([0-9]),x}).x'\n      - 'master'\n      - 'next'\n      - 'next-major'\n      - 'beta'\n      - 'alpha'\n      - '!all-contributors/**'\n  pull_request: {}\njobs:\n  main:\n    # ignore all-contributors PRs\n    if: ${{ !contains(github.head_ref, 'all-contributors') }}\n    strategy:\n      matrix:\n        os: [ubuntu-latest, macos-latest]\n        node: [12, 14, 15]\n    runs-on: ${{ matrix.os }}\n    steps:\n      - name: 🛑 Cancel Previous Runs\n        uses: styfle/cancel-workflow-action@0.6.0\n        with:\n          access_token: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: ⬇️ Checkout repo\n        uses: actions/checkout@v2\n\n      - name: ⎔ Setup node\n        uses: actions/setup-node@v1\n        with:\n          node-version: ${{ matrix.node }}\n\n      - name: 📥 Download deps\n        uses: bahmutov/npm-install@v1\n        with:\n          useLockFile: false\n          working-directory: 'nodejs/packages/scripts'\n\n      - name: ▶️ Run validate script\n        working-directory: 'nodejs/packages/scripts'\n        run: npm run validate\n\n      - name: ⬆️ Upload coverage report\n        uses: codecov/codecov-action@v1\n        with:\n          directory: 'nodejs/packages/scripts/coverage/'\n\n  release:\n    needs: main\n    runs-on: ubuntu-latest\n    if:\n      ${{ github.repository == 'gsmlg-dev/Foundation' \u0026\u0026\n      contains('refs/heads/master,refs/heads/beta,refs/heads/next,refs/heads/alpha',\n      github.ref) \u0026\u0026 github.event_name == 'push' }}\n    steps:\n      - name: 🛑 Cancel Previous Runs\n        uses: styfle/cancel-workflow-action@0.6.0\n        with:\n          access_token: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: ⬇️ Checkout repo\n        uses: actions/checkout@v2\n\n      - name: ⎔ Setup node\n        uses: actions/setup-node@v1\n        with:\n          node-version: 14\n\n      - name: 📥 Download deps\n        uses: bahmutov/npm-install@v1\n        with:\n          useLockFile: false\n          working-directory: 'nodejs/packages/scripts'\n\n      - name: 🏗 Run build script\n        working-directory: 'nodejs/packages/scripts'\n        run: npm run build\n\n      - name: 🚀 Release\n        uses: gsmlg/semantic-release-action@v2\n        with:\n          working-directory: 'nodejs/packages/scripts'\n          semantic_version: 17\n          branches: |\n            [\n              '+([0-9])?(.{+([0-9]),x}).x',\n              'master',\n              'next',\n              'next-major',\n              {name: 'beta', prerelease: true},\n              {name: 'alpha', prerelease: true}\n            ]\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          NPM_TOKEN: ${{ secrets.NPM_TOKEN }}\n```\n","date":"2021-02-25","id":51,"slug":"semantic-release","title":"语义化版本发布"},"lightCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#c18401}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}","darkCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#e6c07b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}"},"__N_SSG":true},"page":"/blogs/[slug]","query":{"slug":"semantic-release"},"buildId":"HMCjgee_YAXnCP6s2jMGQ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>