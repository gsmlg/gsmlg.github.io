<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width"/><meta name="theme-color" content="#1976d2"/><title>使用 s2i Build镜像</title><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="5"/><meta name="theme-color" content="#1976d2"/><link rel="preload" href="/_next/static/css/b192415249a5ea5e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b192415249a5ea5e.css" data-n-g=""/><link rel="preload" href="/_next/static/css/c2a527101433f11d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c2a527101433f11d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-a287909b40ce69d4.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-01df828e572375b9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a5b9b8103dea0669.js" defer=""></script><script src="/_next/static/chunks/eb1842f2-20fe0ca1aebd61de.js" defer=""></script><script src="/_next/static/chunks/947-6c5efbe14cad6a14.js" defer=""></script><script src="/_next/static/chunks/515-af39179dcd4b6b44.js" defer=""></script><script src="/_next/static/chunks/pages/blogs/%5Bslug%5D-bf33e1380166809a.js" defer=""></script><script src="/_next/static/18nFAao2IBxASdMZ-oLtx/_buildManifest.js" defer=""></script><script src="/_next/static/18nFAao2IBxASdMZ-oLtx/_ssgManifest.js" defer=""></script><script src="/_next/static/18nFAao2IBxASdMZ-oLtx/_middlewareManifest.js" defer=""></script><style data-emotion="css "></style></head><body><div id="__next" data-reactroot=""><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><section class="css-1vqbnt3"><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-1x7skt0"><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-191lty2"><div status="[object Object]" class="css-ad3hhb"></div><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeLarge css-1l1167e" tabindex="0" type="button" aria-label="Menu"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button><p class="MuiTypography-root MuiTypography-body1 css-1ikde92" type="title"><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/">Home</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/blogs">Blog</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/presentations">Presentation</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/tools">Tool</a></button><button class="MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButtonBase-root  css-b7766g" tabindex="0" type="button"><a href="/games">Game</a></button></p></div></header><section class="css-xxwux"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation4 css-gnirli"><header><h1 class="MuiTypography-root MuiTypography-body1 css-9l3uo3">使用 s2i Build镜像</h1><div class="MuiTypography-root MuiTypography-body1 css-9l3uo3">Author:<!-- -->Gao</div><div class="MuiTypography-root MuiTypography-body1 css-9l3uo3">Created At:<!-- -->2019-08-15</div></header><hr class="MuiDivider-root MuiDivider-fullWidth css-39bbo6"/><section class="MuiTypography-root MuiTypography-body1 blog-content css-9l3uo3"><div class="css-1xqzmcn"><h1>使用 <code>s2i</code> Build 镜像</h1>
<h2>安装<code>s2i</code></h2>
<ul>
<li>使用 <code>go get</code></li>
</ul>
<pre><code class="hljs language-shell"><span class="hljs-meta">$ </span><span class="bash">go get github.com/openshift/source-to-image/cmd/s2i</span>
</code></pre>
<ul>
<li>macOS 使用</li>
</ul>
<pre><code class="hljs language-shell"><span class="hljs-meta">$ </span><span class="bash">brew install source-to-image</span>
</code></pre>
<ul>
<li>Linux 使用</li>
</ul>
<p>在<a href="https://github.com/openshift/source-to-image/releases">版本发布页面</a>找到对应
链接下载</p>
<pre><code class="hljs language-shell">curl -sSL https://github.com/openshift/source-to-image/releases/download/v1.1.14/source-to-image-v1.1.14-874754de-linux-amd64.tar.gz | tar zxf - -C /usr/local/bin/ &#x27;./s2i&#x27;
</code></pre>
<ul>
<li>Windows 使用</li>
</ul>
<p>在<a href="https://github.com/openshift/source-to-image/releases">版本发布页面</a>找到对应
链接下载</p>
<p>下载</p>
<pre><code class="hljs language-awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/openshift/</span>source-to-image<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/v1.1.14/</span>source-to-image-v1.<span class="hljs-number">1.14</span>-<span class="hljs-number">874754</span>de-windows-amd64.zip
</code></pre>
<ul>
<li>源码编译</li>
</ul>
<pre><code class="hljs language-shell"><span class="hljs-meta">$ </span><span class="bash">go get github.com/openshift/source-to-image</span>
<span class="hljs-meta">$ </span><span class="bash"><span class="hljs-built_in">cd</span> <span class="hljs-variable">${GOPATH}</span>/src/github.com/openshift/source-to-image</span>
<span class="hljs-meta">$ </span><span class="bash"><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">${GOPATH}</span>/src/github.com/openshift/source-to-image/_output/local/bin/linux/amd64/</span>
<span class="hljs-meta">$ </span><span class="bash">hack/build-go.sh</span>
</code></pre>
<h2>使用<code>s2i</code></h2>
<p>使用方式为：</p>
<pre><code class="hljs language-shell">s2i [source dir] [builder image] [built image name]
</code></pre>
<p>可用的 builder 镜像源码可以在 <a href="https://github.com/sclorg">Software Collection</a>
找到</p>
<h3>创建镜像 PHP 项目镜像</h3>
<p>PHP builder 镜像</p>
<ul>
<li>centos/php-72-centos7</li>
<li>centos/php-71-centos7</li>
<li>centos/php-70-centos7</li>
<li>centos/php-56-centos7</li>
<li>centos/php-55-centos7</li>
</ul>
<p>创建 test-app 镜像</p>
<pre><code class="hljs language-stata">s2i build /root/s2i-php-<span class="hljs-keyword">test</span>-<span class="hljs-keyword">app</span> centos/php-72-centos7 my-<span class="hljs-keyword">test</span>-<span class="hljs-keyword">app</span>

docker <span class="hljs-keyword">run</span> --<span class="hljs-keyword">rm</span> -p 8080:8080 my-<span class="hljs-keyword">test</span>-<span class="hljs-keyword">app</span>

</code></pre>
<h4>配置运行时参数</h4>
<h5>给镜像配置以下环境变量可以作用于<code>php.ini</code>:</h5>
<ul>
<li><strong>ERROR_REPORTING</strong>
<ul>
<li>Informs PHP of which errors, warnings and notices you would like it to take
action for</li>
<li>Default: E_ALL &amp; ~E_NOTICE</li>
</ul>
</li>
<li><strong>DISPLAY_ERRORS</strong>
<ul>
<li>Controls whether or not and where PHP will output errors, notices and
warnings</li>
<li>Default: ON</li>
</ul>
</li>
<li><strong>DISPLAY_STARTUP_ERRORS</strong>
<ul>
<li>Cause display errors which occur during PHP&#x27;s startup sequence to be handled
separately from display errors</li>
<li>Default: OFF</li>
</ul>
</li>
<li><strong>TRACK_ERRORS</strong>
<ul>
<li>Store the last error/warning message in $php_errormsg (boolean)</li>
<li>Default: OFF</li>
</ul>
</li>
<li><strong>HTML_ERRORS</strong>
<ul>
<li>Link errors to documentation related to the error</li>
<li>Default: ON</li>
</ul>
</li>
<li><strong>INCLUDE_PATH</strong>
<ul>
<li>Path for PHP source files</li>
<li>Default: .:/opt/app-root/src:/opt/rh/rh-php72/root/usr/share/pear (EL7)</li>
<li>Default: .:/opt/app-root/src:/usr/share/pear (EL8, Fedora)</li>
</ul>
</li>
<li><strong>PHP_MEMORY_LIMIT</strong>
<ul>
<li>Memory Limit</li>
<li>Default: 128M</li>
</ul>
</li>
<li><strong>SESSION_NAME</strong>
<ul>
<li>Name of the session</li>
<li>Default: PHPSESSID</li>
</ul>
</li>
<li><strong>SESSION_HANDLER</strong>
<ul>
<li>Method for saving sessions</li>
<li>Default: files</li>
</ul>
</li>
<li><strong>SESSION_PATH</strong>
<ul>
<li>Location for session data files</li>
<li>Default: /tmp/sessions</li>
</ul>
</li>
<li><strong>SESSION_COOKIE_DOMAIN</strong>
<ul>
<li>The domain for which the cookie is valid.</li>
<li>Default:</li>
</ul>
</li>
<li><strong>SESSION_COOKIE_HTTPONLY</strong>
<ul>
<li>Whether or not to add the httpOnly flag to the cookie</li>
<li>Default: 0</li>
</ul>
</li>
<li><strong>SESSION_COOKIE_SECURE</strong>
<ul>
<li>Specifies whether cookies should only be sent over secure connections.</li>
<li>Default: Off</li>
</ul>
</li>
<li><strong>SHORT_OPEN_TAG</strong>
<ul>
<li>Determines whether or not PHP will recognize code between <!-- -->&lt;? and ?&gt;<!-- --> tags</li>
<li>Default: OFF</li>
</ul>
</li>
<li><strong>DOCUMENTROOT</strong>
<ul>
<li>Path that defines the DocumentRoot for your application (ie. /public)</li>
<li>Default: /</li>
</ul>
</li>
</ul>
<h5>给镜像配置以下环境变量可以作用于<code>opcache.ini</code>:</h5>
<ul>
<li><strong>OPCACHE_MEMORY_CONSUMPTION</strong>
<ul>
<li>The OPcache shared memory storage size in megabytes</li>
<li>Default: 128</li>
</ul>
</li>
<li><strong>OPCACHE_REVALIDATE_FREQ</strong>
<ul>
<li>How often to check script timestamps for updates, in seconds. 0 will result
in OPcache checking for updates on every request.</li>
<li>Default: 2</li>
</ul>
</li>
</ul>
<h5>以下配置环境变量作用于 Apache 服务，运行于 Apache <a href="https://httpd.apache.org/docs/2.4/mod/mpm_common.html">MPM prefork</a> 模式:</h5>
<ul>
<li><strong>HTTPD_START_SERVERS</strong>
<ul>
<li>The
<a href="https://httpd.apache.org/docs/2.4/mod/mpm_common.html#startservers">StartServers</a>
directive sets the number of child server processes created on startup.</li>
<li>Default: 8</li>
</ul>
</li>
<li><strong>HTTPD_MAX_REQUEST_WORKERS</strong>
<ul>
<li>The
<a href="https://httpd.apache.org/docs/2.4/mod/mpm_common.html#maxrequestworkers">MaxRequestWorkers</a>
directive sets the limit on the number of simultaneous requests that will be
served.</li>
<li><code>MaxRequestWorkers</code> was called <code>MaxClients</code> before version httpd 2.3.13.</li>
<li>Default: 256 (this is automatically tuned by setting Cgroup limits for the
container using this formula: <code>TOTAL_MEMORY / 15MB</code>. The 15MB is average
size of a single httpd process.</li>
</ul>
</li>
</ul>
<h5>以下配置环境变量作用于 composer:</h5>
<ul>
<li><strong>COMPOSER_MIRROR</strong>
<ul>
<li>Adds a custom composer repository mirror URL to composer configuration.
Note: This only affects packages listed in composer.json.</li>
</ul>
</li>
<li><strong>COMPOSER_INSTALLER</strong>
<ul>
<li>Overrides the default URL for downloading Composer of
<a href="https://getcomposer.org/installer">https://getcomposer.org/installer</a>. Useful in disconnected environments.</li>
</ul>
</li>
<li><strong>COMPOSER_ARGS</strong>
<ul>
<li>Adds extra arguments to the <code>composer install</code> command line (for example
<code>--no-dev</code>).</li>
</ul>
</li>
</ul>
<h4>代码目录配置</h4>
<p>当以下文件在代码目录中时，会被使用：</p>
<ul>
<li>
<p><strong>composer.json</strong></p>
<p>List of dependencies to be installed with <code>composer</code>. The format is documented
<a href="https://getcomposer.org/doc/04-schema.md">here</a>.</p>
</li>
</ul>
<ul>
<li>
<p><strong>.htaccess</strong></p>
<p>In case the <strong>DocumentRoot</strong> of the application is nested within the source
directory <code>/opt/app-root/src</code>, users can provide their own Apache
<strong>.htaccess</strong> file. This allows the overriding of Apache&#x27;s behavior and
specifies how application requests should be handled. The <strong>.htaccess</strong> file
needs to be located at the root of the application source.</p>
</li>
<li>
<p><strong>.s2i/environment</strong></p>
<p>也可以用于配置环境变量</p>
</li>
</ul>
<h3>创建 nodejs 项目镜像</h3>
<p>可用 builder 镜像</p>
<ul>
<li>centos/nodejs-10-centos7</li>
<li>centos/nodejs-8-centos7</li>
<li>centos/nodejs-6-centos7</li>
</ul>
<h4>服务启动</h4>
<p>默认会调用 <code>npm start</code> 来启动服务</p>
<p>当<code>DEV_MODE=true</code>时，默认会调用<code>nodemon &lt;main attribute in package.json&gt;</code>,来启动
服务，如果失败再调用，<code>npm start</code> 来启动服务</p>
<h4>可配置环境变量</h4>
<p><strong><code>NODE_ENV</code></strong> NodeJS runtime mode (default: &quot;production&quot;)</p>
<p><strong><code>DEV_MODE</code></strong> When set to &quot;true&quot;, <code>nodemon</code> will be used to automatically
reload the server while you work (default: &quot;false&quot;). Setting <code>DEV_MODE</code> to
&quot;true&quot; will change the <code>NODE_ENV</code> default to &quot;development&quot; (if not explicitly
set).</p>
<p><strong><code>NPM_RUN</code></strong> Select an alternate / custom runtime mode, defined in your
<code>package.json</code> file&#x27;s <a href="https://docs.npmjs.com/misc/scripts"><code>scripts</code></a> section
(default: npm run &quot;start&quot;). These user-defined run-scripts are unavailable while
<code>DEV_MODE</code> is in use.</p>
<p><strong><code>HTTP_PROXY</code></strong> Use an npm proxy during assembly</p>
<p><strong><code>HTTPS_PROXY</code></strong> Use an npm proxy during assembly</p>
<p><strong><code>NPM_MIRROR</code></strong> Use a custom NPM registry mirror to download packages during
the build process</p>
<h3>创建 go 项目镜像</h3>
<p>可用 builder 镜像</p>
<ul>
<li>centos/go-toolset-7-centos7</li>
</ul>
<h4>配置运行时参数</h4>
<ul>
<li><strong>IMPORT_URL</strong></li>
</ul>
<p>指定应用的导入 URL，如 <code>github.com/someorg/somerepo</code></p>
<ul>
<li><strong>INSTALL_URL</strong></li>
</ul>
<p>如果<code>main.go</code>不在代码目录下时，指定 build 目录,如
<code>github.com/someorg/somerepo/somefolder</code></p>
<h3>创建 java 项目镜像</h3>
<p>由于 java 项目的多样性，建议进行定制</p></div></section></div></section><footer style="margin-top:0" class="css-6haedj"><div class="container"><span id="icp-info" class="css-z2a085">京ICP备20014476号-2</span><span>Copyright © 2017-2021 GSMLG - Powered by GSMLG Web.</span></div></footer></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"build-with-s2i","blog":{"author":"Gao","content":"# 使用 `s2i` Build 镜像\n\n## 安装`s2i`\n\n- 使用 `go get`\n\n```shell\n$ go get github.com/openshift/source-to-image/cmd/s2i\n```\n\n- macOS 使用\n\n```shell\n$ brew install source-to-image\n```\n\n- Linux 使用\n\n在[版本发布页面](https://github.com/openshift/source-to-image/releases)找到对应\n链接下载\n\n```shell\ncurl -sSL https://github.com/openshift/source-to-image/releases/download/v1.1.14/source-to-image-v1.1.14-874754de-linux-amd64.tar.gz | tar zxf - -C /usr/local/bin/ './s2i'\n```\n\n- Windows 使用\n\n在[版本发布页面](https://github.com/openshift/source-to-image/releases)找到对应\n链接下载\n\n下载\n\n```\nhttps://github.com/openshift/source-to-image/releases/download/v1.1.14/source-to-image-v1.1.14-874754de-windows-amd64.zip\n```\n\n- 源码编译\n\n```shell\n$ go get github.com/openshift/source-to-image\n$ cd ${GOPATH}/src/github.com/openshift/source-to-image\n$ export PATH=$PATH:${GOPATH}/src/github.com/openshift/source-to-image/_output/local/bin/linux/amd64/\n$ hack/build-go.sh\n```\n\n## 使用`s2i`\n\n使用方式为：\n\n```shell\ns2i [source dir] [builder image] [built image name]\n```\n\n可用的 builder 镜像源码可以在 [Software Collection](https://github.com/sclorg)\n找到\n\n### 创建镜像 PHP 项目镜像\n\nPHP builder 镜像\n\n- centos/php-72-centos7\n- centos/php-71-centos7\n- centos/php-70-centos7\n- centos/php-56-centos7\n- centos/php-55-centos7\n\n创建 test-app 镜像\n\n```\ns2i build /root/s2i-php-test-app centos/php-72-centos7 my-test-app\n\ndocker run --rm -p 8080:8080 my-test-app\n\n```\n\n#### 配置运行时参数\n\n##### 给镜像配置以下环境变量可以作用于`php.ini`:\n\n- **ERROR_REPORTING**\n  - Informs PHP of which errors, warnings and notices you would like it to take\n    action for\n  - Default: E_ALL \u0026 ~E_NOTICE\n- **DISPLAY_ERRORS**\n  - Controls whether or not and where PHP will output errors, notices and\n    warnings\n  - Default: ON\n- **DISPLAY_STARTUP_ERRORS**\n  - Cause display errors which occur during PHP's startup sequence to be handled\n    separately from display errors\n  - Default: OFF\n- **TRACK_ERRORS**\n  - Store the last error/warning message in \\$php_errormsg (boolean)\n  - Default: OFF\n- **HTML_ERRORS**\n  - Link errors to documentation related to the error\n  - Default: ON\n- **INCLUDE_PATH**\n  - Path for PHP source files\n  - Default: .:/opt/app-root/src:/opt/rh/rh-php72/root/usr/share/pear (EL7)\n  - Default: .:/opt/app-root/src:/usr/share/pear (EL8, Fedora)\n- **PHP_MEMORY_LIMIT**\n  - Memory Limit\n  - Default: 128M\n- **SESSION_NAME**\n  - Name of the session\n  - Default: PHPSESSID\n- **SESSION_HANDLER**\n  - Method for saving sessions\n  - Default: files\n- **SESSION_PATH**\n  - Location for session data files\n  - Default: /tmp/sessions\n- **SESSION_COOKIE_DOMAIN**\n  - The domain for which the cookie is valid.\n  - Default:\n- **SESSION_COOKIE_HTTPONLY**\n  - Whether or not to add the httpOnly flag to the cookie\n  - Default: 0\n- **SESSION_COOKIE_SECURE**\n  - Specifies whether cookies should only be sent over secure connections.\n  - Default: Off\n- **SHORT_OPEN_TAG**\n  - Determines whether or not PHP will recognize code between \u003c? and ?\u003e tags\n  - Default: OFF\n- **DOCUMENTROOT**\n  - Path that defines the DocumentRoot for your application (ie. /public)\n  - Default: /\n\n##### 给镜像配置以下环境变量可以作用于`opcache.ini`:\n\n- **OPCACHE_MEMORY_CONSUMPTION**\n  - The OPcache shared memory storage size in megabytes\n  - Default: 128\n- **OPCACHE_REVALIDATE_FREQ**\n  - How often to check script timestamps for updates, in seconds. 0 will result\n    in OPcache checking for updates on every request.\n  - Default: 2\n\n##### 以下配置环境变量作用于 Apache 服务，运行于 Apache [MPM prefork](https://httpd.apache.org/docs/2.4/mod/mpm_common.html) 模式:\n\n- **HTTPD_START_SERVERS**\n  - The\n    [StartServers](https://httpd.apache.org/docs/2.4/mod/mpm_common.html#startservers)\n    directive sets the number of child server processes created on startup.\n  - Default: 8\n- **HTTPD_MAX_REQUEST_WORKERS**\n  - The\n    [MaxRequestWorkers](https://httpd.apache.org/docs/2.4/mod/mpm_common.html#maxrequestworkers)\n    directive sets the limit on the number of simultaneous requests that will be\n    served.\n  - `MaxRequestWorkers` was called `MaxClients` before version httpd 2.3.13.\n  - Default: 256 (this is automatically tuned by setting Cgroup limits for the\n    container using this formula: `TOTAL_MEMORY / 15MB`. The 15MB is average\n    size of a single httpd process.\n\n##### 以下配置环境变量作用于 composer:\n\n- **COMPOSER_MIRROR**\n  - Adds a custom composer repository mirror URL to composer configuration.\n    Note: This only affects packages listed in composer.json.\n- **COMPOSER_INSTALLER**\n  - Overrides the default URL for downloading Composer of\n    https://getcomposer.org/installer. Useful in disconnected environments.\n- **COMPOSER_ARGS**\n  - Adds extra arguments to the `composer install` command line (for example\n    `--no-dev`).\n\n#### 代码目录配置\n\n当以下文件在代码目录中时，会被使用：\n\n- **composer.json**\n\n  List of dependencies to be installed with `composer`. The format is documented\n  [here](https://getcomposer.org/doc/04-schema.md).\n\n* **.htaccess**\n\n  In case the **DocumentRoot** of the application is nested within the source\n  directory `/opt/app-root/src`, users can provide their own Apache\n  **.htaccess** file. This allows the overriding of Apache's behavior and\n  specifies how application requests should be handled. The **.htaccess** file\n  needs to be located at the root of the application source.\n\n* **.s2i/environment**\n\n  也可以用于配置环境变量\n\n### 创建 nodejs 项目镜像\n\n可用 builder 镜像\n\n- centos/nodejs-10-centos7\n- centos/nodejs-8-centos7\n- centos/nodejs-6-centos7\n\n#### 服务启动\n\n默认会调用 `npm start` 来启动服务\n\n当`DEV_MODE=true`时，默认会调用`nodemon \u003cmain attribute in package.json\u003e`,来启动\n服务，如果失败再调用，`npm start` 来启动服务\n\n#### 可配置环境变量\n\n**`NODE_ENV`** NodeJS runtime mode (default: \"production\")\n\n**`DEV_MODE`** When set to \"true\", `nodemon` will be used to automatically\nreload the server while you work (default: \"false\"). Setting `DEV_MODE` to\n\"true\" will change the `NODE_ENV` default to \"development\" (if not explicitly\nset).\n\n**`NPM_RUN`** Select an alternate / custom runtime mode, defined in your\n`package.json` file's [`scripts`](https://docs.npmjs.com/misc/scripts) section\n(default: npm run \"start\"). These user-defined run-scripts are unavailable while\n`DEV_MODE` is in use.\n\n**`HTTP_PROXY`** Use an npm proxy during assembly\n\n**`HTTPS_PROXY`** Use an npm proxy during assembly\n\n**`NPM_MIRROR`** Use a custom NPM registry mirror to download packages during\nthe build process\n\n### 创建 go 项目镜像\n\n可用 builder 镜像\n\n- centos/go-toolset-7-centos7\n\n#### 配置运行时参数\n\n- **IMPORT_URL**\n\n指定应用的导入 URL，如 `github.com/someorg/somerepo`\n\n- **INSTALL_URL**\n\n如果`main.go`不在代码目录下时，指定 build 目录,如\n`github.com/someorg/somerepo/somefolder`\n\n### 创建 java 项目镜像\n\n由于 java 项目的多样性，建议进行定制\n","date":"2019-08-15","id":33,"slug":"build-with-s2i","title":"使用 s2i Build镜像"},"lightCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#c18401}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}","darkCss":"pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#e6c07b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}"},"__N_SSG":true},"page":"/blogs/[slug]","query":{"slug":"build-with-s2i"},"buildId":"18nFAao2IBxASdMZ-oLtx","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>