<!DOCTYPE html><html lang="en"><head><meta name="theme-color" content="#3f51b5"/><meta charSet="utf-8"/><meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width"/><title>HTTP 发布与分发</title><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/a0cf29c14f6d9ec17027.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a0cf29c14f6d9ec17027.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-220fd716662a0b708bf3.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ae3781fe50e43492a499.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.df3badfa1389741d28a2.js" as="script"/><link rel="preload" href="/_next/static/chunks/473c783ce2e4c5b5d95c83f901934eef11700fcb.9759d43e64f6d7948fd8.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-be3797058d7d6e33d8a6.js" as="script"/><link rel="preload" href="/_next/static/chunks/f1a2a027c5898c5311b997a749ce3bdad8d3c05f.1b74e9d720b40ae86260.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blogs/%5Bslug%5D-0f5ddcc393987a77de96.js" as="script"/><style id="jss-server-side">.MuiPaper-root {
  color: rgba(0, 0, 0, 0.87);
  transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  background-color: #fff;
}
.MuiPaper-rounded {
  border-radius: 4px;
}
.MuiPaper-outlined {
  border: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiPaper-elevation0 {
  box-shadow: none;
}
.MuiPaper-elevation1 {
  box-shadow: 0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation2 {
  box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation3 {
  box-shadow: 0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation4 {
  box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation5 {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation6 {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation7 {
  box-shadow: 0px 4px 5px -2px rgba(0,0,0,0.2),0px 7px 10px 1px rgba(0,0,0,0.14),0px 2px 16px 1px rgba(0,0,0,0.12);
}
.MuiPaper-elevation8 {
  box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);
}
.MuiPaper-elevation9 {
  box-shadow: 0px 5px 6px -3px rgba(0,0,0,0.2),0px 9px 12px 1px rgba(0,0,0,0.14),0px 3px 16px 2px rgba(0,0,0,0.12);
}
.MuiPaper-elevation10 {
  box-shadow: 0px 6px 6px -3px rgba(0,0,0,0.2),0px 10px 14px 1px rgba(0,0,0,0.14),0px 4px 18px 3px rgba(0,0,0,0.12);
}
.MuiPaper-elevation11 {
  box-shadow: 0px 6px 7px -4px rgba(0,0,0,0.2),0px 11px 15px 1px rgba(0,0,0,0.14),0px 4px 20px 3px rgba(0,0,0,0.12);
}
.MuiPaper-elevation12 {
  box-shadow: 0px 7px 8px -4px rgba(0,0,0,0.2),0px 12px 17px 2px rgba(0,0,0,0.14),0px 5px 22px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation13 {
  box-shadow: 0px 7px 8px -4px rgba(0,0,0,0.2),0px 13px 19px 2px rgba(0,0,0,0.14),0px 5px 24px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation14 {
  box-shadow: 0px 7px 9px -4px rgba(0,0,0,0.2),0px 14px 21px 2px rgba(0,0,0,0.14),0px 5px 26px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation15 {
  box-shadow: 0px 8px 9px -5px rgba(0,0,0,0.2),0px 15px 22px 2px rgba(0,0,0,0.14),0px 6px 28px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation16 {
  box-shadow: 0px 8px 10px -5px rgba(0,0,0,0.2),0px 16px 24px 2px rgba(0,0,0,0.14),0px 6px 30px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation17 {
  box-shadow: 0px 8px 11px -5px rgba(0,0,0,0.2),0px 17px 26px 2px rgba(0,0,0,0.14),0px 6px 32px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation18 {
  box-shadow: 0px 9px 11px -5px rgba(0,0,0,0.2),0px 18px 28px 2px rgba(0,0,0,0.14),0px 7px 34px 6px rgba(0,0,0,0.12);
}
.MuiPaper-elevation19 {
  box-shadow: 0px 9px 12px -6px rgba(0,0,0,0.2),0px 19px 29px 2px rgba(0,0,0,0.14),0px 7px 36px 6px rgba(0,0,0,0.12);
}
.MuiPaper-elevation20 {
  box-shadow: 0px 10px 13px -6px rgba(0,0,0,0.2),0px 20px 31px 3px rgba(0,0,0,0.14),0px 8px 38px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation21 {
  box-shadow: 0px 10px 13px -6px rgba(0,0,0,0.2),0px 21px 33px 3px rgba(0,0,0,0.14),0px 8px 40px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation22 {
  box-shadow: 0px 10px 14px -6px rgba(0,0,0,0.2),0px 22px 35px 3px rgba(0,0,0,0.14),0px 8px 42px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation23 {
  box-shadow: 0px 11px 14px -7px rgba(0,0,0,0.2),0px 23px 36px 3px rgba(0,0,0,0.14),0px 9px 44px 8px rgba(0,0,0,0.12);
}
.MuiPaper-elevation24 {
  box-shadow: 0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12);
}
.MuiAppBar-root {
  width: 100%;
  display: flex;
  z-index: 1100;
  box-sizing: border-box;
  flex-shrink: 0;
  flex-direction: column;
}
.MuiAppBar-positionFixed {
  top: 0;
  left: auto;
  right: 0;
  position: fixed;
}
@media print {
  .MuiAppBar-positionFixed {
    position: absolute;
  }
}
  .MuiAppBar-positionAbsolute {
    top: 0;
    left: auto;
    right: 0;
    position: absolute;
  }
  .MuiAppBar-positionSticky {
    top: 0;
    left: auto;
    right: 0;
    position: sticky;
  }
  .MuiAppBar-positionStatic {
    position: static;
  }
  .MuiAppBar-positionRelative {
    position: relative;
  }
  .MuiAppBar-colorDefault {
    color: rgba(0, 0, 0, 0.87);
    background-color: #f5f5f5;
  }
  .MuiAppBar-colorPrimary {
    color: #fff;
    background-color: #3f51b5;
  }
  .MuiAppBar-colorSecondary {
    color: #fff;
    background-color: #f50057;
  }
  .MuiAppBar-colorInherit {
    color: inherit;
  }
  .MuiAppBar-colorTransparent {
    color: inherit;
    background-color: transparent;
  }
  .MuiToolbar-root {
    display: flex;
    position: relative;
    align-items: center;
  }
  .MuiToolbar-gutters {
    padding-left: 16px;
    padding-right: 16px;
  }
@media (min-width:600px) {
  .MuiToolbar-gutters {
    padding-left: 24px;
    padding-right: 24px;
  }
}
  .MuiToolbar-regular {
    min-height: 56px;
  }
@media (min-width:0px) and (orientation: landscape) {
  .MuiToolbar-regular {
    min-height: 48px;
  }
}
@media (min-width:600px) {
  .MuiToolbar-regular {
    min-height: 64px;
  }
}
  .MuiToolbar-dense {
    min-height: 48px;
  }
  .MuiTypography-root {
    margin: 0;
  }
  .MuiTypography-body2 {
    font-size: 0.875rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 1.43;
    letter-spacing: 0.01071em;
  }
  .MuiTypography-body1 {
    font-size: 1rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 1.5;
    letter-spacing: 0.00938em;
  }
  .MuiTypography-caption {
    font-size: 0.75rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 1.66;
    letter-spacing: 0.03333em;
  }
  .MuiTypography-button {
    font-size: 0.875rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 500;
    line-height: 1.75;
    letter-spacing: 0.02857em;
    text-transform: uppercase;
  }
  .MuiTypography-h1 {
    font-size: 6rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 300;
    line-height: 1.167;
    letter-spacing: -0.01562em;
  }
  .MuiTypography-h2 {
    font-size: 3.75rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 300;
    line-height: 1.2;
    letter-spacing: -0.00833em;
  }
  .MuiTypography-h3 {
    font-size: 3rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 1.167;
    letter-spacing: 0em;
  }
  .MuiTypography-h4 {
    font-size: 2.125rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 1.235;
    letter-spacing: 0.00735em;
  }
  .MuiTypography-h5 {
    font-size: 1.5rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 1.334;
    letter-spacing: 0em;
  }
  .MuiTypography-h6 {
    font-size: 1.25rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 500;
    line-height: 1.6;
    letter-spacing: 0.0075em;
  }
  .MuiTypography-subtitle1 {
    font-size: 1rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 1.75;
    letter-spacing: 0.00938em;
  }
  .MuiTypography-subtitle2 {
    font-size: 0.875rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 500;
    line-height: 1.57;
    letter-spacing: 0.00714em;
  }
  .MuiTypography-overline {
    font-size: 0.75rem;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 400;
    line-height: 2.66;
    letter-spacing: 0.08333em;
    text-transform: uppercase;
  }
  .MuiTypography-srOnly {
    width: 1px;
    height: 1px;
    overflow: hidden;
    position: absolute;
  }
  .MuiTypography-alignLeft {
    text-align: left;
  }
  .MuiTypography-alignCenter {
    text-align: center;
  }
  .MuiTypography-alignRight {
    text-align: right;
  }
  .MuiTypography-alignJustify {
    text-align: justify;
  }
  .MuiTypography-noWrap {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .MuiTypography-gutterBottom {
    margin-bottom: 0.35em;
  }
  .MuiTypography-paragraph {
    margin-bottom: 16px;
  }
  .MuiTypography-colorInherit {
    color: inherit;
  }
  .MuiTypography-colorPrimary {
    color: #3f51b5;
  }
  .MuiTypography-colorSecondary {
    color: #f50057;
  }
  .MuiTypography-colorTextPrimary {
    color: rgba(0, 0, 0, 0.87);
  }
  .MuiTypography-colorTextSecondary {
    color: rgba(0, 0, 0, 0.54);
  }
  .MuiTypography-colorError {
    color: #f44336;
  }
  .MuiTypography-displayInline {
    display: inline;
  }
  .MuiTypography-displayBlock {
    display: block;
  }
  .MuiButtonBase-root {
    color: inherit;
    border: 0;
    cursor: pointer;
    margin: 0;
    display: inline-flex;
    outline: 0;
    padding: 0;
    position: relative;
    align-items: center;
    user-select: none;
    border-radius: 0;
    vertical-align: middle;
    -moz-appearance: none;
    justify-content: center;
    text-decoration: none;
    background-color: transparent;
    -webkit-appearance: none;
    -webkit-tap-highlight-color: transparent;
  }
  .MuiButtonBase-root::-moz-focus-inner {
    border-style: none;
  }
  .MuiButtonBase-root.Mui-disabled {
    cursor: default;
    pointer-events: none;
  }
@media print {
  .MuiButtonBase-root {
    color-adjust: exact;
  }
}
  .MuiButton-root {
    color: rgba(0, 0, 0, 0.87);
    padding: 6px 16px;
    font-size: 0.875rem;
    min-width: 64px;
    box-sizing: border-box;
    transition: background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
    font-weight: 500;
    line-height: 1.75;
    border-radius: 4px;
    letter-spacing: 0.02857em;
    text-transform: uppercase;
  }
  .MuiButton-root:hover {
    text-decoration: none;
    background-color: rgba(0, 0, 0, 0.04);
  }
  .MuiButton-root.Mui-disabled {
    color: rgba(0, 0, 0, 0.26);
  }
@media (hover: none) {
  .MuiButton-root:hover {
    background-color: transparent;
  }
}
  .MuiButton-root:hover.Mui-disabled {
    background-color: transparent;
  }
  .MuiButton-label {
    width: 100%;
    display: inherit;
    align-items: inherit;
    justify-content: inherit;
  }
  .MuiButton-text {
    padding: 6px 8px;
  }
  .MuiButton-textPrimary {
    color: #3f51b5;
  }
  .MuiButton-textPrimary:hover {
    background-color: rgba(63, 81, 181, 0.04);
  }
@media (hover: none) {
  .MuiButton-textPrimary:hover {
    background-color: transparent;
  }
}
  .MuiButton-textSecondary {
    color: #f50057;
  }
  .MuiButton-textSecondary:hover {
    background-color: rgba(245, 0, 87, 0.04);
  }
@media (hover: none) {
  .MuiButton-textSecondary:hover {
    background-color: transparent;
  }
}
  .MuiButton-outlined {
    border: 1px solid rgba(0, 0, 0, 0.23);
    padding: 5px 15px;
  }
  .MuiButton-outlined.Mui-disabled {
    border: 1px solid rgba(0, 0, 0, 0.12);
  }
  .MuiButton-outlinedPrimary {
    color: #3f51b5;
    border: 1px solid rgba(63, 81, 181, 0.5);
  }
  .MuiButton-outlinedPrimary:hover {
    border: 1px solid #3f51b5;
    background-color: rgba(63, 81, 181, 0.04);
  }
@media (hover: none) {
  .MuiButton-outlinedPrimary:hover {
    background-color: transparent;
  }
}
  .MuiButton-outlinedSecondary {
    color: #f50057;
    border: 1px solid rgba(245, 0, 87, 0.5);
  }
  .MuiButton-outlinedSecondary:hover {
    border: 1px solid #f50057;
    background-color: rgba(245, 0, 87, 0.04);
  }
  .MuiButton-outlinedSecondary.Mui-disabled {
    border: 1px solid rgba(0, 0, 0, 0.26);
  }
@media (hover: none) {
  .MuiButton-outlinedSecondary:hover {
    background-color: transparent;
  }
}
  .MuiButton-contained {
    color: rgba(0, 0, 0, 0.87);
    box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
    background-color: #e0e0e0;
  }
  .MuiButton-contained:hover {
    box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);
    background-color: #d5d5d5;
  }
  .MuiButton-contained.Mui-focusVisible {
    box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);
  }
  .MuiButton-contained:active {
    box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);
  }
  .MuiButton-contained.Mui-disabled {
    color: rgba(0, 0, 0, 0.26);
    box-shadow: none;
    background-color: rgba(0, 0, 0, 0.12);
  }
@media (hover: none) {
  .MuiButton-contained:hover {
    box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
    background-color: #e0e0e0;
  }
}
  .MuiButton-contained:hover.Mui-disabled {
    background-color: rgba(0, 0, 0, 0.12);
  }
  .MuiButton-containedPrimary {
    color: #fff;
    background-color: #3f51b5;
  }
  .MuiButton-containedPrimary:hover {
    background-color: #303f9f;
  }
@media (hover: none) {
  .MuiButton-containedPrimary:hover {
    background-color: #3f51b5;
  }
}
  .MuiButton-containedSecondary {
    color: #fff;
    background-color: #f50057;
  }
  .MuiButton-containedSecondary:hover {
    background-color: #c51162;
  }
@media (hover: none) {
  .MuiButton-containedSecondary:hover {
    background-color: #f50057;
  }
}
  .MuiButton-disableElevation {
    box-shadow: none;
  }
  .MuiButton-disableElevation:hover {
    box-shadow: none;
  }
  .MuiButton-disableElevation.Mui-focusVisible {
    box-shadow: none;
  }
  .MuiButton-disableElevation:active {
    box-shadow: none;
  }
  .MuiButton-disableElevation.Mui-disabled {
    box-shadow: none;
  }
  .MuiButton-colorInherit {
    color: inherit;
    border-color: currentColor;
  }
  .MuiButton-textSizeSmall {
    padding: 4px 5px;
    font-size: 0.8125rem;
  }
  .MuiButton-textSizeLarge {
    padding: 8px 11px;
    font-size: 0.9375rem;
  }
  .MuiButton-outlinedSizeSmall {
    padding: 3px 9px;
    font-size: 0.8125rem;
  }
  .MuiButton-outlinedSizeLarge {
    padding: 7px 21px;
    font-size: 0.9375rem;
  }
  .MuiButton-containedSizeSmall {
    padding: 4px 10px;
    font-size: 0.8125rem;
  }
  .MuiButton-containedSizeLarge {
    padding: 8px 22px;
    font-size: 0.9375rem;
  }
  .MuiButton-fullWidth {
    width: 100%;
  }
  .MuiButton-startIcon {
    display: inherit;
    margin-left: -4px;
    margin-right: 8px;
  }
  .MuiButton-startIcon.MuiButton-iconSizeSmall {
    margin-left: -2px;
  }
  .MuiButton-endIcon {
    display: inherit;
    margin-left: 8px;
    margin-right: -4px;
  }
  .MuiButton-endIcon.MuiButton-iconSizeSmall {
    margin-right: -2px;
  }
  .MuiButton-iconSizeSmall > *:first-child {
    font-size: 18px;
  }
  .MuiButton-iconSizeMedium > *:first-child {
    font-size: 20px;
  }
  .MuiButton-iconSizeLarge > *:first-child {
    font-size: 22px;
  }
  .MuiIconButton-root {
    flex: 0 0 auto;
    color: rgba(0, 0, 0, 0.54);
    padding: 12px;
    overflow: visible;
    font-size: 1.5rem;
    text-align: center;
    transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
    border-radius: 50%;
  }
  .MuiIconButton-root:hover {
    background-color: rgba(0, 0, 0, 0.04);
  }
  .MuiIconButton-root.Mui-disabled {
    color: rgba(0, 0, 0, 0.26);
    background-color: transparent;
  }
@media (hover: none) {
  .MuiIconButton-root:hover {
    background-color: transparent;
  }
}
  .MuiIconButton-edgeStart {
    margin-left: -12px;
  }
  .MuiIconButton-sizeSmall.MuiIconButton-edgeStart {
    margin-left: -3px;
  }
  .MuiIconButton-edgeEnd {
    margin-right: -12px;
  }
  .MuiIconButton-sizeSmall.MuiIconButton-edgeEnd {
    margin-right: -3px;
  }
  .MuiIconButton-colorInherit {
    color: inherit;
  }
  .MuiIconButton-colorPrimary {
    color: #3f51b5;
  }
  .MuiIconButton-colorPrimary:hover {
    background-color: rgba(63, 81, 181, 0.04);
  }
@media (hover: none) {
  .MuiIconButton-colorPrimary:hover {
    background-color: transparent;
  }
}
  .MuiIconButton-colorSecondary {
    color: #f50057;
  }
  .MuiIconButton-colorSecondary:hover {
    background-color: rgba(245, 0, 87, 0.04);
  }
@media (hover: none) {
  .MuiIconButton-colorSecondary:hover {
    background-color: transparent;
  }
}
  .MuiIconButton-sizeSmall {
    padding: 3px;
    font-size: 1.125rem;
  }
  .MuiIconButton-label {
    width: 100%;
    display: flex;
    align-items: inherit;
    justify-content: inherit;
  }
  .MuiSvgIcon-root {
    fill: currentColor;
    width: 1em;
    height: 1em;
    display: inline-block;
    font-size: 1.5rem;
    transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
    flex-shrink: 0;
    user-select: none;
  }
  .MuiSvgIcon-colorPrimary {
    color: #3f51b5;
  }
  .MuiSvgIcon-colorSecondary {
    color: #f50057;
  }
  .MuiSvgIcon-colorAction {
    color: rgba(0, 0, 0, 0.54);
  }
  .MuiSvgIcon-colorError {
    color: #f44336;
  }
  .MuiSvgIcon-colorDisabled {
    color: rgba(0, 0, 0, 0.26);
  }
  .MuiSvgIcon-fontSizeInherit {
    font-size: inherit;
  }
  .MuiSvgIcon-fontSizeSmall {
    font-size: 1.25rem;
  }
  .MuiSvgIcon-fontSizeLarge {
    font-size: 2.1875rem;
  }
  .jss2 {
    flex: 1 1 auto;
    width: 100vw;
    display: flex;
    min-height: 100vh;
    flex-direction: column;
  }
  .jss3 {
    flex: 1;
    display: flex;
  }
  .jss4 {
    color: #fff;
    margin-top: 0.5em;
    text-align: center;
    line-height: 2em;
    background-color: #3f51b5;
  }
  .jss5 {
    margin-left: -12px;
    margin-right: 20px;
  }
  .jss7 {
    font-weight: bold;
    margin-left: 20px;
    margin-right: 20px;
  }
  .MuiDivider-root {
    border: none;
    height: 1px;
    margin: 0;
    flex-shrink: 0;
    background-color: rgba(0, 0, 0, 0.12);
  }
  .MuiDivider-absolute {
    left: 0;
    width: 100%;
    bottom: 0;
    position: absolute;
  }
  .MuiDivider-inset {
    margin-left: 72px;
  }
  .MuiDivider-light {
    background-color: rgba(0, 0, 0, 0.08);
  }
  .MuiDivider-middle {
    margin-left: 16px;
    margin-right: 16px;
  }
  .MuiDivider-vertical {
    width: 1px;
    height: 100%;
  }
  .MuiDivider-flexItem {
    height: auto;
    align-self: stretch;
  }
  .jss1 {
    flex: 1;
    margin: 24px;
    padding-top: 16px;
    padding-left: 16px;
    padding-right: 16px;
    padding-bottom: 16px;
  }
@media (min-width:600px) {
  .jss1 {
    padding-left: 24px;
    padding-right: 24px;
  }
}</style></head><body><div id="__next"><section class="jss2"><header class="MuiPaper-root MuiAppBar-root MuiAppBar-positionStatic MuiAppBar-colorPrimary MuiPaper-elevation4"><div class="MuiToolbar-root MuiToolbar-regular MuiToolbar-gutters"><button class="MuiButtonBase-root MuiIconButton-root jss5 MuiIconButton-colorInherit" tabindex="0" type="button" aria-label="Menu"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></span></button><p class="MuiTypography-root jss3 MuiTypography-body1 MuiTypography-colorInherit" type="title"><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-colorInherit" tabindex="0" type="button"><span class="MuiButton-label"><a href="/">Home</a></span></button><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-colorInherit" tabindex="0" type="button"><span class="MuiButton-label"><a href="/blogs">Blog</a></span></button><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-colorInherit" tabindex="0" type="button"><span class="MuiButton-label"><a href="/presentations">Presentation</a></span></button><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-colorInherit" tabindex="0" type="button"><span class="MuiButton-label"><a href="/tools">Tool</a></span></button><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-colorInherit" tabindex="0" type="button"><span class="MuiButton-label"><a href="/games">Game</a></span></button></p></div></header><section class="jss3"><div class="MuiPaper-root jss1 MuiPaper-elevation4 MuiPaper-rounded"><header><h1 class="MuiTypography-root MuiTypography-body1">HTTP 发布与分发</h1><div class="MuiTypography-root MuiTypography-body1">Author:<!-- -->Gao</div><div class="MuiTypography-root MuiTypography-body1">Created At:<!-- -->2020-06-09</div></header><hr class="MuiDivider-root"/><section class="MuiTypography-root blog-content MuiTypography-body1"><h1>内容发布与分发</h1><h2>主机托管服务</h2><p>对内容资源的存储、协调以及管理的职责统称为 Web 主机托管。</p><p>主机托管是 Web 服务器的主要功能之一。</p><h3>Web 主机托管</h3><h4>主机托管服务</h4><ul><li>简单例子--专用托管</li></ul><p>例如：</p><ul><li>DigitalOcean Bare Metal Server</li><li>Vultr Bare Metal Server</li><li>华为云 裸金属服务器</li></ul><ul><li>虚拟主机托管</li></ul><p>例如：</p><ul><li>Google App Engine</li><li>Sina App Engine</li><li>Github Pages</li></ul><h4>虚拟服务器请求缺乏主机信息</h4><p>不幸的是，HTTP/1.0 中的一个设计缺陷会使虚拟主机托管者抓狂。
HTTP/1.0 规范中没有为共享的 Web 服务器提供任何方法来识别要访问的是所托管的哪个虚拟网站。</p><h4>设法让虚拟主机托管正常工作</h4><ul><li>通过 URL 路径进行虚拟主机托管</li></ul><p>在 URL 中增添专门的路径部分，以便服务器判断是哪个网站。</p><ul><li>通过端口号进行主机托管</li></ul><p>为每个站点分配不同的端口号，这样请求就由 Web 服务器的单独实例来处理。</p><ul><li>通过 IP 地址进行主机托管</li></ul><p>为不同的虚拟站点分配专门的 IP 地址，把这些地址都绑定到一台单独的机器上。
这样，Web 服务器就可以通过 IP 地址来识别网站名了。</p><ul><li>通过 Host 首部进行主机托管</li></ul><p>很多 Web 托管者向 HTTP 的设计者施压，要求解决这个问题。
HTTP/1.0 的增强 版和 HTTP/1.1 的正式版定义了 Host 请求首部来携带网站名称。
Web 服务器可 以通过 Host 首部识别虚拟站点。</p><h4>HTTP/1.1 的 Host 首部</h4><p>Host 首部是 HTTP/1.1 的请求首部，定义在 RFC 2068 中。</p><ol><li><strong>语法与用法</strong></li></ol><p>Host 首部描述了所请求的资源所在的因特网主机和端口号，和原始的 URL 中得到 的一样:</p><pre><code>Host = &quot;Host&quot; &quot;:&quot; host [ &quot;:&quot; port ]</code></pre><p>需要注意 ⚠️：</p><ul><li><p>如果 Host 首部不包含端口，就使用地址方案中默认的端口。</p></li><li><p>如果 URL 中包含 IP 地址，Host 首部就应当包含同样的地址。</p></li><li><p>如果 URL 中包含主机名，Host 首部就必须包含同样的名字。</p></li><li><p>如果 URL 中包含主机名，Host 首部就不应当包含 URL 中这个主机名对应的 IP 地址，
因为这样会扰乱虚拟主机托管服务器的工作，它在同一个 IP 地址上堆叠了很多虚拟站点。</p></li><li><p>如果 URL 中包含主机名，Host 首部就不应当包含这个主机名的其他别名，因为这样也会扰乱虚拟主机托管服务器的工作。</p></li><li><p>如果客户端显式地使用代理服务器，客户端就必须把原始服务器，而不是代理服务器的名字和端口放在 Host 首部中。
以往，若干个 Web 客户端在启用客户端代理设置时，错误地把发出的 Host 首部设置成代理的主机名。
这种错误行为会使代理和原始服务器都无法正常处理请求。</p></li><li><p>Web 客户端必须在所有请求报文中包含 Host 首部。</p></li><li><p>Web 代理必须在转发请求报文之前，添加 Host 首部。</p></li><li><p>HTTP/1.1 的 Web 服务器必须用 400 状态码来响应所有缺少 Host 首部字段的 HTTP/1.1 请求报文。</p></li></ul><ol start="2"><li><strong>缺失 Host 首部</strong></li></ol><p>过去有老式浏览器不会发送 Host 首部，现在默认不会出现这个问题。</p><p>但是如果缺失 Host 的话，服务器可能会返回默认页面，或者返回错误页面。</p><ol start="3"><li><p><strong>解释 Host 首部</strong></p></li><li><p>如果 HTTP 请求报文中的 URL 是绝对的(也就是说，包含方案和主机部分)， 就忽略 Host 首部的值。</p></li><li><p>如果 HTTP 请求报文中的 URL 没有主机部分，而该请求带有 Host 首部，则主 机 / 端口的值就从 Host 首部中取。</p></li><li><p>如果通过第(1)步或第(2)步都无法获得有效的主机，就向客户端返回 400 Bad Request 响应。</p></li></ol><ol start="4"><li><strong>Host 首部与代理</strong></li></ol><p>某些版本的浏览器发送的 Host 首部不正确，尤其是配置使用代理的时候。
例如，配置使用代理时，一些老版本的 Apple 和 PointCast 客户端会错误地把代理的名字，
而不是原始服务器的名字放在 Host 首部里发送。</p><h3>使网站更可靠</h3><p>在下面列出的这些时间段内，网站通常是无法运作的。</p><ul><li><p>服务器宕机的时候。</p></li><li><p>交通拥堵:突然间很多人都要看某个特别的新闻广播或涌向某个大甩卖网店。
突然的拥堵可以使 Web 服务器过载，降低其响应速度，甚至使它彻底停机。</p></li><li><p>网络中断或掉线。</p></li></ul><h4>镜像的服务器集群</h4><p><img src="http-publish-distribution/mirror.png" alt=""/></p><p>有以下两种方法把客户端的请求导向特定的服务器。</p><ul><li>HTTP 重定向</li></ul><p>该内容的 URL 会解析到主服务器的 IP 地址，然后它会发送重定向到复制服务器。</p><ul><li>DNS 重定向</li></ul><p>该内容的 URL 会解析到 4 个 IP 地址，DNS 服务器可以选择发送给客户端的 IP 地址。</p><h4>内容分发网络</h4><p>简单地说，内容分发网络(CDN)就是对特定内容进行分发的专门网络。</p><p>这个网络中的节点可以是 Web 服务器、反向代理或缓存。</p><h4>CDN 中的反向代理缓存</h4><p>具体实现可以参考<code>varnish</code></p><h4>CDN 中的代理缓存</h4><p>与反向代理不同，传统的 代理缓存能收到发往任何 Web 服务器的请求。
(在代理缓存与原始服务器之间不需 要有任何工作关系或 IP 地址约定。)
但是与反向代理比起来，代理缓存的内容一般 都是按需驱动的，不能指望它是对原始服务器内容的精确复制。
某些代理缓存也可以预先载入热点内容。</p><p>按需驱动的代理缓存可以部署在其他环境中——尤其是拦截环境，
在这种情况下，2 层 或 3 层设备(交换机或路由器)会拦截 Web 流量并将其发送给代理缓存。</p><p><img src="http-publish-distribution/proxy-cache.png" alt=""/></p><h3>让网站更快</h3><p>服务器集群和分布式代理缓存 或反向代理服务器分散了网络流量，可以避免拥塞。</p><p>分发内容使之更靠近终端用户，这样从服务器到客户端的传输时间就更短了。</p><p>请求和响应穿过因特网，在客户端和服务器间传输的方式是影响资源访问速度最主要的因素。</p><h3>更多信息</h3><ul><li><a href="http://www.ietf.org/rfc/rfc3040.txt">http://www.ietf.org/rfc/rfc3040.txt</a></li></ul><p>RFC 3040，“Internet Web Replication and Caching Taxonomy”(“因特网 Web 复 制和缓存分类法”)，这份文档是关于 Web 复制与缓存应用术语的参考文献。</p><ul><li><a href="http://search.ietf.org/internet-drafts/draft-ietf-cdi-request-routing-reqs-00.txt">http://search.ietf.org/internet-drafts/draft-ietf-cdi-request-routing-reqs-00.txt</a></li></ul><p>“Request-Routing Requirements for Content Internetworking”(“内容网际互连的请求路由需求”)。</p><ul><li>Apache: The Definitive Guide1(《Apache 权威指南》)</li></ul><p>Ben Laurie 和 Peter Laurie 著，O’Reilly &amp; Associates 公司出版。这本书讲述如何运行开源的 Apache Web 服务器。</p><h2>发布系统</h2><p>许多支持远程发布内容的工具都使用了扩展的 HTTP 协议。</p><p>以 HTTP 为 基础的两种重要的 Web 内容发布技术:FrontPage 和 DAV。</p><h3>FrontPage 为支持发布而做的服务器扩展</h3><p>FrontPage(FP)是微软公司提供的一种通用 Web 写作和发布工具包。</p><pre><code>Microsoft FrontPage（全名Microsoft Office FrontPage）是Microsoft停止提供的Microsoft Windows系列操作系统的WYSIWYG HTML编辑器和网站管理工具。
从1997年到2003年，它被商标为Microsoft Office套件的一部分。
此后，Microsoft FrontPage被Microsoft Expression Web和SharePoint Designer所取代，
后者于2006年12月与Microsoft Office 2007一起首次发布，但这两款产品也不再支持基于Web的SharePoint Designer版本，因为这三个HTML编辑器是桌面应用程序。</code></pre><h3>WebDAV 与协作写作</h3><p>WebDAV(作为 RFC 2518 发表)专注于对 HTTP 进行扩展，以提供协作写作的适宜平台。</p><p>WebDAV 提供了许多的 HTTP 请求方法和首部集，并定义了一些 HTTP 状态响应码。</p><p>WebDAV 数据交换使用 XML 格式。</p><p>在 RFC 3253 中为 WebDAV 加入了版本管理功能。</p><p>现在可以将 WebDAV 资源直接挂在到文件系统上，出于安全原因，macOS 仅支持基于 https 的 WebDAV。</p><h2>重定向与负载均衡</h2><p>重定向技术:</p><ul><li>HTTP 重定向;</li><li>DNS 重定向;</li><li>任播路由;</li><li>策略路由;</li><li>IP MAC 转发;</li><li>IP 地址转发;</li><li>WCCP (Web 缓存协调协议);</li><li>ICP (缓存间通信协议);</li><li>HTCP (超文本缓存协议);</li><li>NECP (网元控制协议);</li><li>CARP (缓存阵列路由协议);</li><li>WPAD (Web 代理自动发现协议)。</li></ul><h3>重定向协议概览</h3><ul><li><p>配置创建客户端报文的浏览器应用程序，使其将报文发送给代理服务器。</p></li><li><p>DNS 解析程序会选择用于报文寻址的 IP 地址。对不同物理地域的不同客户端来说，这个 IP 地址可能不同。</p></li><li><p>报文经过网络传输时，会被划分为一些带有地址的分组;交换机和路由器会检查分组中的 TCP/IP 地址，并据此来确定分组的发送路线。</p></li><li><p>Web 服务器可以通过 HTTP 重定向将请求反弹给不同的 Web 服务器。</p></li></ul><h4>通用的重定向方法</h4><h5>HTTP 重定向</h5><p>最初，HTTP 请求先到第一台 Web 服务器，这台服务器会选 择一台“最佳”的 Web 服务器 为其提供内容。
第一台 Web 服 务器会向客户端发送一条到指 定服务器的 HTTP 重定向。
客 户端会将请求重新发送到选中 的服务器上</p><p>选择最短路径时可用的选项很多， 包括轮转 (round-robin) 负载均衡和最小化时延等</p><p>可能会很慢——每个事务都包含了附加的重定向步骤。而且，第一台服务器一定要能够处理请求负载</p><h5>DNS 重定向</h5><p>DNS 服务器决定在 URL 的主机名中返回多个 IP 地址中的哪一个</p><p>选择最短路径时可用的选项很多， 包括轮转 (round-robin) 负载均衡和最小化时延等</p><p>需要配置 DNS 服务器</p><h5>任播寻址</h5><p>几台服务器使用相同的 IP 地 址。
每台服务器都会伪装成一个骨干路由器。
其他路由器会 将共享 IP 地址分组发送给最近的服务器(认为它们将分组发送给最近的路由器)</p><p>路由器有内建的最短路径路由功能</p><p>需要拥有 / 配置路由器。 有地址冲突的风险。
如果路由变化了，与已建立的 TCP 连接相关的分组会被发送到其他的服务器，可能会使 TCP 连接断裂</p><h5>IP MAC 转发</h5><p>交换机或路由器这样的网元会读取分组的目的地址。
如果应该将分组重定向，交换机会将服务器或代理的目标 MAC 地址赋予分组</p><p>节省带宽，提高 QOS。负载均衡</p><p>服务器或代理的跳距必 须是 1</p><h5>IP 地址转发</h5><p>第四层交换机会评估分组的目的端口并将重定向分组的 IP 地址改成代理或镜像服务器的 IP 地址</p><p>节省带宽，提高 QOS。负载均衡</p><p>服务器或代理可能看不到真正的客户端 IP 地址</p><h4>代理与缓存重定向技术</h4><h5>显式浏览器配置</h5><p>配置 Web 浏览器，使其将 HTTP 报文发送给附近的一 个代理，通常是缓存。可以 由终端用户或管理浏览器的 服务进行配置</p><h5>代理自动配置(PAC)</h5><p>Web 浏览器从配置服务器 中解析出 PAC 文件。这个 PAC 文件会告诉浏览器为每 个 URL 使用什么代理</p><p><a href="https://en.wikipedia.org/wiki/Proxy_auto-config">Wiki</a></p><h5>Web Proxy 代理自动发现协议(WPAD)</h5><p>Web 浏览器向配置服务器查询一个 PAC 文件的 URL。 与单独使用 PAC 不同，不需要将浏览器配置为使用特定的配置服务器</p><p><a href="https://en.wikipedia.org/wiki/Web_Proxy_Auto-Discovery_Protocol">Wiki</a></p><h5>Web 缓存协调协议(WCCP)</h5><p>路由器会评估一个分组的目的地址，并用代理或镜像服务器的 IP 地址将重定向分组封装起来。
可以与很多现有路由器共同工作。可以将分组封装起来，这样客户端的 IP 地址就不会丢失了</p><p><a href="https://en.wikipedia.org/wiki/Web_Cache_Communication_Protocol">Wiki</a></p><h5>因特网缓存协议(ICP)</h5><p>代理缓存会在一组兄弟代理 缓存中查询所请求的内容。 还支持缓存的分层结构</p><p><a href="https://en.wikipedia.org/wiki/Internet_Cache_Protocol">Wiki</a></p><h5>缓存分组路由协议(CARP)</h5><p>一种代理缓存散列协议。
允许缓存将请求转发给一个父 缓存。
与 ICP 不同的是，高速缓存上的内容是不相交的，这组缓存会像一个大型缓存那样工作</p><p><a href="https://en.wikipedia.org/wiki/Cache_Array_Routing_Protocol">Wiki</a></p><h5>超文本缓存协议(HTCP)</h5><p>参与的代理缓存可以向一组兄弟缓存查询所请求的内容。
支持 HTTP 1.0 和 1.1 首部，以便精细地调整缓存查询</p><p><a href="https://en.wikipedia.org/wiki/Hypertext_caching_protocol">Wiki</a></p><h2>日志记录与使用情况跟踪</h2><h3>记录内容</h3><p>通常会记录下来的几个字段示例为:</p><ul><li>HTTP 方法;</li><li>客户端和服务器的 HTTP 版本;</li><li>所请求资源的 URL;</li><li>响应的 HTTP 状态码;</li><li>请求和响应报文的尺寸(包含所有的实体主体部分);</li><li>事务开始时的时间戳;</li><li>Referer 首部和 User-Agent 首部的值。</li></ul><h3>日志格式</h3><p>大部分商用和开源的 HTTP 应用程序都支持以一种或多种常用格式进行日志记录。
很多这样的应用程序都支持管理者配置日志格式，创建自定义的格式。</p><p>应用程序支持管理者使用这些更标准的格式的主要好处之一就在于，可以充分利用 那些已构建好的工具处理这些日志，并产生基本的统计信息。</p><h4>常见日志格式</h4><p>最常见的日志格式之一就是常用日志格式。
这种日志格式最初由 NCSA 定义，很多服务器在默认情况下都会使用这种日志格式。</p><h4>组合日志格式</h4><p>另一种常用日志格式为组合日志格式(Combined Log Format)。</p><p>组合日志格式与常用日志格式很类似。
实际上，它就是常用日志格式的精确镜像，只是添加了 <code>Referer</code> 和 <code>User-Agent</code> 两个字段。</p><h4>网景扩展 2 日志格式</h4><p>网景的格式是基于 NCSA 的常用日志格式的，但它们扩展了该格式，以支持与代理和 Web 缓存这样的 HTTP 应用程序相关的字段。</p><p>另一种网景日志格式，网景扩展 2 日志格式采用了扩展日志格式，并添加了一些与 HTTP 代理和 Web 缓存应用程序有关的附加信息。这些附加字段有助于更好地描绘 HTTP 客户端和 HTTP 代理应用程序间的交互图景。</p><h4>Squid 代理日志格式</h4><p>Squid 代理缓存(<a href="http://www.squid-cache.org)是">http://www.squid-cache.org)是</a> Web 上一个很古老的部分。</p><p>有很多工具可以用来辅助管理 Squid 应用程序，包括一些有助于处理、审核及开发 其日志的工具。
很多后继代理缓存都为自己的日志使用了 Squid 格式，这样才能更好地利用这些工具。</p><h3>命中率测量</h3><p>原始服务器通常会出于计费的目的保留详细的日志记录。
内容提供者需要知道 URL 的受访频率，广告商需要知道广告的出现频率，网站作者需要知道所编写的内容的受欢迎程度。
客户端直接访问 Web 服务器时，日志记录可以很好地跟踪这些信息。</p><p>但是，缓存服务器位于客户端和服务器之间，
用于防止服务器同时处理大量访问请求(这正是缓存的目的)。
缓存要处理很多 HTTP 请求，并在不访问原始服务器的情况下满足它们的请求，服务器中没有客户端访问其内容的记录，导致日志文件中出现遗漏。</p><p>由于日志数据会遗失，所以，内容提供者会对其最重要的页面进行缓存清除(cache bust)。
缓存清除是指内容提供者有意将某些内容设置为无法缓存，这样，所有对此内容的请求都会被导向原始服务器。
于是，原始服务器就可以记录下访问情况了。 不使用缓存可能会生成更好的日志，但会减缓原始服务器和网络的请求速度，并增加其负荷。</p><p>由于代理缓存(及一些客户端)都会保留自己的日志，
所以如果服务器能够访问这些日志(或者至少有一种粗略的方式可以判断代理缓存会以怎样的频率提供其内 容)，
就可以避免使用缓存清除。
命中率测量协议是对 HTTP 的一种扩展，它为这个问题提供了一种解决方案。
命中率测量协议要求缓存周期性地向原始服务器汇报缓存访问的统计数据。</p><p>RFC 2227 详细定义了命中率测量协议。</p><h4>概述</h4><p>命中率测量协议定义了一种 HTTP 扩展，它提供了一些基本的功能，缓存和服务器可以实现这些功能来共享访问信息，规范已缓存资源的可使用次数。</p><p>缓存给日志访问带来了问题，命中率测量并不是这个问题的完整解决方案，
但它确实提供了一种基本方式，以获取服务器希望跟踪的度量值。
命中率测量协议并没有(而且可能永远都不会)得到广泛的实现或应用。</p><h4>Meter 首部</h4><p>命中率测量扩展建议使用新增加的首部 Meter，
缓存和服务器可以通过它在相互间传输与用法和报告有关的指令，
这与用来进行缓存指令交换的 Cache-Control 首部很类似。</p><p><img src="http-publish-distribution/meter.png" alt=""/></p><h3>关于隐私的考虑</h3><p>日志记录实际上就是服务器和代理执行的一项管理功能，
所以整个操作对用户来说 都是透明的。
通常，用户甚至都不清楚他们的 HTTP 事务已被记录--实际上，
很 多用户可能甚至都不知道他们访问 Web 上的内容时是在使用 HTTP 协议。</p><p>Web 应用程序的开发者和管理者要清楚跟踪用户的 HTTP 事务可能带来的影响。
他可以根据获取的信息收集很多有关用户的情况。
很显然，这些信息可以用于不良目的--歧视、骚扰、勒索等。
进行日志记录的 Web 服务器和代理一定要注意保护其 终端用户的隐私。</p><h3>更多信息</h3><ul><li><a href="http://httpd.apache.org/docs/logs.html">http://httpd.apache.org/docs/logs.html</a></li></ul><p>“Apache HTTP Server: Log Files”(“Apache HTTP 服务器:日志文件”)。
ApacheHTTP 服务器项目网站。</p><ul><li><a href="http://www.squid-cache.org/Doc/FAQ/FAQ-6.html">http://www.squid-cache.org/Doc/FAQ/FAQ-6.html</a></li></ul><p>“Squid Log Files”(“Squid 日志文件”)。Squid 代理缓存网站。</p><ul><li><a href="http://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format">http://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format</a></li></ul><p>“Logging Control in W3C httpd”(“W3C httpd 中的日志记录控制”)。</p><ul><li><a href="http://www.w3.org/TR/WD-logfile.html">http://www.w3.org/TR/WD-logfile.html</a></li></ul><p>“Extended Log File Format”(“扩展日志文件格式”)。</p><ul><li><a href="http://www.ietf.org/rfc/rfc2227.txt">http://www.ietf.org/rfc/rfc2227.txt</a></li></ul><p>RFC 2227，J. Mogul 和 P. Leach 编写的“Simple Hit-Metering and Usage- Limiting for HTTP”(“简单的 HTTP 命中率测量和使用限制”)。</p></section></div></section><footer class="jss4"><div class="container"><span class="jss8">Copyright © 2017-2020 GSMLG - Powered by GSMLG Web.</span></div></footer></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"http-publish-distribution","blog":{"id":44,"name":"http-publish-distribution","title":"HTTP 发布与分发","date":"2020-06-09","author":"Gao","content":"# 内容发布与分发\n\n## 主机托管服务\n\n对内容资源的存储、协调以及管理的职责统称为 Web 主机托管。\n\n主机托管是 Web 服务器的主要功能之一。\n\n### Web 主机托管\n\n#### 主机托管服务\n\n- 简单例子--专用托管\n\n例如：\n\n- DigitalOcean Bare Metal Server\n- Vultr Bare Metal Server\n- 华为云 裸金属服务器\n\n* 虚拟主机托管\n\n例如：\n\n- Google App Engine\n- Sina App Engine\n- Github Pages\n\n#### 虚拟服务器请求缺乏主机信息\n\n不幸的是，HTTP/1.0 中的一个设计缺陷会使虚拟主机托管者抓狂。\nHTTP/1.0 规范中没有为共享的 Web 服务器提供任何方法来识别要访问的是所托管的哪个虚拟网站。\n\n#### 设法让虚拟主机托管正常工作\n\n- 通过 URL 路径进行虚拟主机托管\n\n在 URL 中增添专门的路径部分，以便服务器判断是哪个网站。\n\n- 通过端口号进行主机托管\n\n为每个站点分配不同的端口号，这样请求就由 Web 服务器的单独实例来处理。\n\n- 通过 IP 地址进行主机托管\n\n为不同的虚拟站点分配专门的 IP 地址，把这些地址都绑定到一台单独的机器上。\n这样，Web 服务器就可以通过 IP 地址来识别网站名了。\n\n- 通过 Host 首部进行主机托管\n\n很多 Web 托管者向 HTTP 的设计者施压，要求解决这个问题。\nHTTP/1.0 的增强 版和 HTTP/1.1 的正式版定义了 Host 请求首部来携带网站名称。\nWeb 服务器可 以通过 Host 首部识别虚拟站点。\n\n#### HTTP/1.1 的 Host 首部\n\nHost 首部是 HTTP/1.1 的请求首部，定义在 RFC 2068 中。\n\n1. **语法与用法**\n\nHost 首部描述了所请求的资源所在的因特网主机和端口号，和原始的 URL 中得到 的一样:\n\n    Host = \"Host\" \":\" host [ \":\" port ]\n\n需要注意 ⚠️：\n\n- 如果 Host 首部不包含端口，就使用地址方案中默认的端口。\n\n- 如果 URL 中包含 IP 地址，Host 首部就应当包含同样的地址。\n\n- 如果 URL 中包含主机名，Host 首部就必须包含同样的名字。\n\n- 如果 URL 中包含主机名，Host 首部就不应当包含 URL 中这个主机名对应的 IP 地址，\n  因为这样会扰乱虚拟主机托管服务器的工作，它在同一个 IP 地址上堆叠了很多虚拟站点。\n\n- 如果 URL 中包含主机名，Host 首部就不应当包含这个主机名的其他别名，因为这样也会扰乱虚拟主机托管服务器的工作。\n\n- 如果客户端显式地使用代理服务器，客户端就必须把原始服务器，而不是代理服务器的名字和端口放在 Host 首部中。\n  以往，若干个 Web 客户端在启用客户端代理设置时，错误地把发出的 Host 首部设置成代理的主机名。\n  这种错误行为会使代理和原始服务器都无法正常处理请求。\n\n- Web 客户端必须在所有请求报文中包含 Host 首部。\n\n- Web 代理必须在转发请求报文之前，添加 Host 首部。\n\n- HTTP/1.1 的 Web 服务器必须用 400 状态码来响应所有缺少 Host 首部字段的 HTTP/1.1 请求报文。\n\n2. **缺失 Host 首部**\n\n过去有老式浏览器不会发送 Host 首部，现在默认不会出现这个问题。\n\n但是如果缺失 Host 的话，服务器可能会返回默认页面，或者返回错误页面。\n\n3. **解释 Host 首部**\n\n1. 如果 HTTP 请求报文中的 URL 是绝对的(也就是说，包含方案和主机部分)， 就忽略 Host 首部的值。\n\n1. 如果 HTTP 请求报文中的 URL 没有主机部分，而该请求带有 Host 首部，则主 机 / 端口的值就从 Host 首部中取。\n\n1. 如果通过第(1)步或第(2)步都无法获得有效的主机，就向客户端返回 400 Bad Request 响应。\n\n4) **Host 首部与代理**\n\n某些版本的浏览器发送的 Host 首部不正确，尤其是配置使用代理的时候。\n例如，配置使用代理时，一些老版本的 Apple 和 PointCast 客户端会错误地把代理的名字，\n而不是原始服务器的名字放在 Host 首部里发送。\n\n### 使网站更可靠\n\n在下面列出的这些时间段内，网站通常是无法运作的。\n\n- 服务器宕机的时候。\n\n- 交通拥堵:突然间很多人都要看某个特别的新闻广播或涌向某个大甩卖网店。\n  突然的拥堵可以使 Web 服务器过载，降低其响应速度，甚至使它彻底停机。\n\n- 网络中断或掉线。\n\n#### 镜像的服务器集群\n\n![](http-publish-distribution/mirror.png)\n\n有以下两种方法把客户端的请求导向特定的服务器。\n\n- HTTP 重定向\n\n该内容的 URL 会解析到主服务器的 IP 地址，然后它会发送重定向到复制服务器。\n\n- DNS 重定向\n\n该内容的 URL 会解析到 4 个 IP 地址，DNS 服务器可以选择发送给客户端的 IP 地址。\n\n#### 内容分发网络\n\n简单地说，内容分发网络(CDN)就是对特定内容进行分发的专门网络。\n\n这个网络中的节点可以是 Web 服务器、反向代理或缓存。\n\n#### CDN 中的反向代理缓存\n\n具体实现可以参考`varnish`\n\n#### CDN 中的代理缓存\n\n与反向代理不同，传统的 代理缓存能收到发往任何 Web 服务器的请求。\n(在代理缓存与原始服务器之间不需 要有任何工作关系或 IP 地址约定。)\n但是与反向代理比起来，代理缓存的内容一般 都是按需驱动的，不能指望它是对原始服务器内容的精确复制。\n某些代理缓存也可以预先载入热点内容。\n\n按需驱动的代理缓存可以部署在其他环境中——尤其是拦截环境，\n在这种情况下，2 层 或 3 层设备(交换机或路由器)会拦截 Web 流量并将其发送给代理缓存。\n\n![](http-publish-distribution/proxy-cache.png)\n\n### 让网站更快\n\n服务器集群和分布式代理缓存 或反向代理服务器分散了网络流量，可以避免拥塞。\n\n分发内容使之更靠近终端用户，这样从服务器到客户端的传输时间就更短了。\n\n请求和响应穿过因特网，在客户端和服务器间传输的方式是影响资源访问速度最主要的因素。\n\n### 更多信息\n\n- http://www.ietf.org/rfc/rfc3040.txt\n\nRFC 3040，“Internet Web Replication and Caching Taxonomy”(“因特网 Web 复 制和缓存分类法”)，这份文档是关于 Web 复制与缓存应用术语的参考文献。\n\n- http://search.ietf.org/internet-drafts/draft-ietf-cdi-request-routing-reqs-00.txt\n\n“Request-Routing Requirements for Content Internetworking”(“内容网际互连的请求路由需求”)。\n\n- Apache: The Definitive Guide1(《Apache 权威指南》)\n\nBen Laurie 和 Peter Laurie 著，O’Reilly \u0026 Associates 公司出版。这本书讲述如何运行开源的 Apache Web 服务器。\n\n## 发布系统\n\n许多支持远程发布内容的工具都使用了扩展的 HTTP 协议。\n\n以 HTTP 为 基础的两种重要的 Web 内容发布技术:FrontPage 和 DAV。\n\n### FrontPage 为支持发布而做的服务器扩展\n\nFrontPage(FP)是微软公司提供的一种通用 Web 写作和发布工具包。\n\n    Microsoft FrontPage（全名Microsoft Office FrontPage）是Microsoft停止提供的Microsoft Windows系列操作系统的WYSIWYG HTML编辑器和网站管理工具。\n    从1997年到2003年，它被商标为Microsoft Office套件的一部分。\n    此后，Microsoft FrontPage被Microsoft Expression Web和SharePoint Designer所取代，\n    后者于2006年12月与Microsoft Office 2007一起首次发布，但这两款产品也不再支持基于Web的SharePoint Designer版本，因为这三个HTML编辑器是桌面应用程序。\n\n### WebDAV 与协作写作\n\nWebDAV(作为 RFC 2518 发表)专注于对 HTTP 进行扩展，以提供协作写作的适宜平台。\n\nWebDAV 提供了许多的 HTTP 请求方法和首部集，并定义了一些 HTTP 状态响应码。\n\nWebDAV 数据交换使用 XML 格式。\n\n在 RFC 3253 中为 WebDAV 加入了版本管理功能。\n\n现在可以将 WebDAV 资源直接挂在到文件系统上，出于安全原因，macOS 仅支持基于 https 的 WebDAV。\n\n## 重定向与负载均衡\n\n重定向技术:\n\n- HTTP 重定向;\n- DNS 重定向;\n- 任播路由;\n- 策略路由;\n- IP MAC 转发;\n- IP 地址转发;\n- WCCP (Web 缓存协调协议);\n- ICP (缓存间通信协议);\n- HTCP (超文本缓存协议);\n- NECP (网元控制协议);\n- CARP (缓存阵列路由协议);\n- WPAD (Web 代理自动发现协议)。\n\n### 重定向协议概览\n\n- 配置创建客户端报文的浏览器应用程序，使其将报文发送给代理服务器。\n\n- DNS 解析程序会选择用于报文寻址的 IP 地址。对不同物理地域的不同客户端来说，这个 IP 地址可能不同。\n\n- 报文经过网络传输时，会被划分为一些带有地址的分组;交换机和路由器会检查分组中的 TCP/IP 地址，并据此来确定分组的发送路线。\n\n- Web 服务器可以通过 HTTP 重定向将请求反弹给不同的 Web 服务器。\n\n#### 通用的重定向方法\n\n##### HTTP 重定向\n\n最初，HTTP 请求先到第一台 Web 服务器，这台服务器会选 择一台“最佳”的 Web 服务器 为其提供内容。\n第一台 Web 服 务器会向客户端发送一条到指 定服务器的 HTTP 重定向。\n客 户端会将请求重新发送到选中 的服务器上\n\n选择最短路径时可用的选项很多， 包括轮转 (round-robin) 负载均衡和最小化时延等\n\n可能会很慢——每个事务都包含了附加的重定向步骤。而且，第一台服务器一定要能够处理请求负载\n\n##### DNS 重定向\n\nDNS 服务器决定在 URL 的主机名中返回多个 IP 地址中的哪一个\n\n选择最短路径时可用的选项很多， 包括轮转 (round-robin) 负载均衡和最小化时延等\n\n需要配置 DNS 服务器\n\n##### 任播寻址\n\n几台服务器使用相同的 IP 地 址。\n每台服务器都会伪装成一个骨干路由器。\n其他路由器会 将共享 IP 地址分组发送给最近的服务器(认为它们将分组发送给最近的路由器)\n\n路由器有内建的最短路径路由功能\n\n需要拥有 / 配置路由器。 有地址冲突的风险。\n如果路由变化了，与已建立的 TCP 连接相关的分组会被发送到其他的服务器，可能会使 TCP 连接断裂\n\n##### IP MAC 转发\n\n交换机或路由器这样的网元会读取分组的目的地址。\n如果应该将分组重定向，交换机会将服务器或代理的目标 MAC 地址赋予分组\n\n节省带宽，提高 QOS。负载均衡\n\n服务器或代理的跳距必 须是 1\n\n##### IP 地址转发\n\n第四层交换机会评估分组的目的端口并将重定向分组的 IP 地址改成代理或镜像服务器的 IP 地址\n\n节省带宽，提高 QOS。负载均衡\n\n服务器或代理可能看不到真正的客户端 IP 地址\n\n#### 代理与缓存重定向技术\n\n##### 显式浏览器配置\n\n配置 Web 浏览器，使其将 HTTP 报文发送给附近的一 个代理，通常是缓存。可以 由终端用户或管理浏览器的 服务进行配置\n\n##### 代理自动配置(PAC)\n\nWeb 浏览器从配置服务器 中解析出 PAC 文件。这个 PAC 文件会告诉浏览器为每 个 URL 使用什么代理\n\n[Wiki](https://en.wikipedia.org/wiki/Proxy_auto-config)\n\n##### Web Proxy 代理自动发现协议(WPAD)\n\nWeb 浏览器向配置服务器查询一个 PAC 文件的 URL。 与单独使用 PAC 不同，不需要将浏览器配置为使用特定的配置服务器\n\n[Wiki](https://en.wikipedia.org/wiki/Web_Proxy_Auto-Discovery_Protocol)\n\n##### Web 缓存协调协议(WCCP)\n\n路由器会评估一个分组的目的地址，并用代理或镜像服务器的 IP 地址将重定向分组封装起来。\n可以与很多现有路由器共同工作。可以将分组封装起来，这样客户端的 IP 地址就不会丢失了\n\n[Wiki](https://en.wikipedia.org/wiki/Web_Cache_Communication_Protocol)\n\n##### 因特网缓存协议(ICP)\n\n代理缓存会在一组兄弟代理 缓存中查询所请求的内容。 还支持缓存的分层结构\n\n[Wiki](https://en.wikipedia.org/wiki/Internet_Cache_Protocol)\n\n##### 缓存分组路由协议(CARP)\n\n一种代理缓存散列协议。\n允许缓存将请求转发给一个父 缓存。\n与 ICP 不同的是，高速缓存上的内容是不相交的，这组缓存会像一个大型缓存那样工作\n\n[Wiki](https://en.wikipedia.org/wiki/Cache_Array_Routing_Protocol)\n\n##### 超文本缓存协议(HTCP)\n\n参与的代理缓存可以向一组兄弟缓存查询所请求的内容。\n支持 HTTP 1.0 和 1.1 首部，以便精细地调整缓存查询\n\n[Wiki](https://en.wikipedia.org/wiki/Hypertext_caching_protocol)\n\n## 日志记录与使用情况跟踪\n\n### 记录内容\n\n通常会记录下来的几个字段示例为:\n\n- HTTP 方法;\n- 客户端和服务器的 HTTP 版本;\n- 所请求资源的 URL;\n- 响应的 HTTP 状态码;\n- 请求和响应报文的尺寸(包含所有的实体主体部分);\n- 事务开始时的时间戳;\n- Referer 首部和 User-Agent 首部的值。\n\n### 日志格式\n\n大部分商用和开源的 HTTP 应用程序都支持以一种或多种常用格式进行日志记录。\n很多这样的应用程序都支持管理者配置日志格式，创建自定义的格式。\n\n应用程序支持管理者使用这些更标准的格式的主要好处之一就在于，可以充分利用 那些已构建好的工具处理这些日志，并产生基本的统计信息。\n\n#### 常见日志格式\n\n最常见的日志格式之一就是常用日志格式。\n这种日志格式最初由 NCSA 定义，很多服务器在默认情况下都会使用这种日志格式。\n\n#### 组合日志格式\n\n另一种常用日志格式为组合日志格式(Combined Log Format)。\n\n组合日志格式与常用日志格式很类似。\n实际上，它就是常用日志格式的精确镜像，只是添加了 `Referer` 和 `User-Agent` 两个字段。\n\n#### 网景扩展 2 日志格式\n\n网景的格式是基于 NCSA 的常用日志格式的，但它们扩展了该格式，以支持与代理和 Web 缓存这样的 HTTP 应用程序相关的字段。\n\n另一种网景日志格式，网景扩展 2 日志格式采用了扩展日志格式，并添加了一些与 HTTP 代理和 Web 缓存应用程序有关的附加信息。这些附加字段有助于更好地描绘 HTTP 客户端和 HTTP 代理应用程序间的交互图景。\n\n#### Squid 代理日志格式\n\nSquid 代理缓存(http://www.squid-cache.org)是 Web 上一个很古老的部分。\n\n有很多工具可以用来辅助管理 Squid 应用程序，包括一些有助于处理、审核及开发 其日志的工具。\n很多后继代理缓存都为自己的日志使用了 Squid 格式，这样才能更好地利用这些工具。\n\n### 命中率测量\n\n原始服务器通常会出于计费的目的保留详细的日志记录。\n内容提供者需要知道 URL 的受访频率，广告商需要知道广告的出现频率，网站作者需要知道所编写的内容的受欢迎程度。\n客户端直接访问 Web 服务器时，日志记录可以很好地跟踪这些信息。\n\n但是，缓存服务器位于客户端和服务器之间，\n用于防止服务器同时处理大量访问请求(这正是缓存的目的)。\n缓存要处理很多 HTTP 请求，并在不访问原始服务器的情况下满足它们的请求，服务器中没有客户端访问其内容的记录，导致日志文件中出现遗漏。\n\n由于日志数据会遗失，所以，内容提供者会对其最重要的页面进行缓存清除(cache bust)。\n缓存清除是指内容提供者有意将某些内容设置为无法缓存，这样，所有对此内容的请求都会被导向原始服务器。\n于是，原始服务器就可以记录下访问情况了。 不使用缓存可能会生成更好的日志，但会减缓原始服务器和网络的请求速度，并增加其负荷。\n\n由于代理缓存(及一些客户端)都会保留自己的日志，\n所以如果服务器能够访问这些日志(或者至少有一种粗略的方式可以判断代理缓存会以怎样的频率提供其内 容)，\n就可以避免使用缓存清除。\n命中率测量协议是对 HTTP 的一种扩展，它为这个问题提供了一种解决方案。\n命中率测量协议要求缓存周期性地向原始服务器汇报缓存访问的统计数据。\n\nRFC 2227 详细定义了命中率测量协议。\n\n#### 概述\n\n命中率测量协议定义了一种 HTTP 扩展，它提供了一些基本的功能，缓存和服务器可以实现这些功能来共享访问信息，规范已缓存资源的可使用次数。\n\n缓存给日志访问带来了问题，命中率测量并不是这个问题的完整解决方案，\n但它确实提供了一种基本方式，以获取服务器希望跟踪的度量值。\n命中率测量协议并没有(而且可能永远都不会)得到广泛的实现或应用。\n\n#### Meter 首部\n\n命中率测量扩展建议使用新增加的首部 Meter，\n缓存和服务器可以通过它在相互间传输与用法和报告有关的指令，\n这与用来进行缓存指令交换的 Cache-Control 首部很类似。\n\n![](http-publish-distribution/meter.png)\n\n### 关于隐私的考虑\n\n日志记录实际上就是服务器和代理执行的一项管理功能，\n所以整个操作对用户来说 都是透明的。\n通常，用户甚至都不清楚他们的 HTTP 事务已被记录--实际上，\n很 多用户可能甚至都不知道他们访问 Web 上的内容时是在使用 HTTP 协议。\n\nWeb 应用程序的开发者和管理者要清楚跟踪用户的 HTTP 事务可能带来的影响。\n他可以根据获取的信息收集很多有关用户的情况。\n很显然，这些信息可以用于不良目的--歧视、骚扰、勒索等。\n进行日志记录的 Web 服务器和代理一定要注意保护其 终端用户的隐私。\n\n### 更多信息\n\n- http://httpd.apache.org/docs/logs.html\n\n“Apache HTTP Server: Log Files”(“Apache HTTP 服务器:日志文件”)。\nApacheHTTP 服务器项目网站。\n\n- http://www.squid-cache.org/Doc/FAQ/FAQ-6.html\n\n“Squid Log Files”(“Squid 日志文件”)。Squid 代理缓存网站。\n\n- http://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format\n\n“Logging Control in W3C httpd”(“W3C httpd 中的日志记录控制”)。\n\n- http://www.w3.org/TR/WD-logfile.html\n\n“Extended Log File Format”(“扩展日志文件格式”)。\n\n- http://www.ietf.org/rfc/rfc2227.txt\n\nRFC 2227，J. Mogul 和 P. Leach 编写的“Simple Hit-Metering and Usage- Limiting for HTTP”(“简单的 HTTP 命中率测量和使用限制”)。\n"}},"__N_SSG":true},"page":"/blogs/[slug]","query":{"slug":"http-publish-distribution"},"buildId":"DMZDU2GIM6TQVi2gnuKE3","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-c404d6afeb7944ba47a6.js"></script><script src="/_next/static/chunks/main-220fd716662a0b708bf3.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.ae3781fe50e43492a499.js" async=""></script><script src="/_next/static/chunks/commons.df3badfa1389741d28a2.js" async=""></script><script src="/_next/static/chunks/473c783ce2e4c5b5d95c83f901934eef11700fcb.9759d43e64f6d7948fd8.js" async=""></script><script src="/_next/static/chunks/pages/_app-be3797058d7d6e33d8a6.js" async=""></script><script src="/_next/static/chunks/f1a2a027c5898c5311b997a749ce3bdad8d3c05f.1b74e9d720b40ae86260.js" async=""></script><script src="/_next/static/chunks/pages/blogs/%5Bslug%5D-0f5ddcc393987a77de96.js" async=""></script><script src="/_next/static/DMZDU2GIM6TQVi2gnuKE3/_buildManifest.js" async=""></script><script src="/_next/static/DMZDU2GIM6TQVi2gnuKE3/_ssgManifest.js" async=""></script></body></html>